<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dose-Response Data Analysis Workflow • protti</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dose-Response Data Analysis Workflow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/protein_structure_workflow.html">Protein Structure Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dose-Response Data Analysis Workflow</h1>
                        <h4 data-toc-skip class="author">Jan-Philipp
Quast</h4>
            
            <h4 data-toc-skip class="date">2026-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/master/vignettes/data_analysis_dose_response_workflow.Rmd" class="external-link"><code>vignettes/data_analysis_dose_response_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>data_analysis_dose_response_workflow.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will take you through all important steps for the
analysis of dose-response experiments with <strong>protti</strong>. For
experiments with treatment titrations (i.e. samples treated with
different amounts of the same compound, protein, metabolite, element,
ion, etc.) you can fit sigmoidal log-logistic regression curves to the
data and determine significantly changing precursors, peptides or
proteins based on Pearson correlation and ANOVA q-value.</p>
<p>Before analysing your data please ensure that it is of sufficient
quality by using <strong>protti</strong>’s quality control functions
(see <a href="https://jpquast.github.io/protti/articles/quality_control_workflow.html" class="external-link">Quality
control (QC) workflow</a>) If you would like to compare a control
condition with one treatment condition (or multiple unrelated
treatments) you can check out the <a href="https://jpquast.github.io/protti/articles/data_analysis_single_dose_treatment_workflow.html" class="external-link">data
analysis vignette for single dose treatment data</a>. For help with data
input please click <a href="https://jpquast.github.io/protti/articles/input_preparation_workflow.html" class="external-link">here</a>.</p>
<p>A typical dose-response experiment contains multiple samples that
were treated with different amounts of e.g. a drug. Replicates of
samples treated with the same dose make up a condition. Commonly, the
first concentration is 0 (i.e. the control, in which treatment is with
the solvent of the drug). Dose-response treatments require a minimal
number of treatments to fit curves with sufficient quality. For analysis
with <strong>protti</strong> at least 5 different conditions should be
present. Another consideration for your experiment is the range of
concentrations. They should not be too close together since effects are
usually best identified over a larger concentration range. But you
should make sure not to space them out too far. It is generally advised
to space them evenly on a logarithmic scale of the base 10 or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
(Euler’s number). You can also include steps in between e.g. 100, 500,
1000 or 100, 200, 1000 for a log10 scale. It is advisable to use a
rather broad concentration range for an experiment in which you do not
know what to expect.</p>
<p><strong>protti</strong> fits four-parameter log-logistic
dose-response models to your data. It utilizes the <code>drm()</code>
and <code>LL.4()</code> functions from the <a href="https://doi.org/10.1371/journal.pone.0146021" class="external-link"><code>drc</code></a>
package for this. You can also select a non logarithmic model using the
<code>L.4()</code> function in case your data does not follow a
log-logistic but a logistic regression.</p>
<p>For limited proteolysis-coupled to mass spectrometry (<a href="https://doi.org/10.1038/nbt.2999" class="external-link">LiP-MS</a>) data, dose-response
curves have been used previously for the identification of drug binding
sites in complex proteomes (<a href="https://doi.org/10.1038/s41467-020-18071-x" class="external-link">Piazza 2020</a>).
Since LiP-MS data is analysed on the peptide or precursor* level, using
additional information about peptide behaviour from multiple conditions
reduces false discovery rate.</p>
<p><em>A peptide precursor is the actual molecular unit that was
detected on the mass spectrometer. This is a peptide with one specific
charge state and its modification(s).</em></p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Before starting the analysis of your data you need to load
<strong>protti</strong> and additional packages used for the analysis.
As described on the <a href="https://jpquast.github.io/protti/index.html" class="external-link">main page</a> of
<strong>protti</strong>, the <a href="https://tidyverse.org/" class="external-link">tidyverse</a> package collection works
well together with the rest of the package, by design. You can load
packages after you installed them with the <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>
function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jpquast/protti" class="external-link">protti</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="loading-data">Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h3>
<p>For this vignette we use a subset of proteins from an experiment of
HeLa cell lysates treated with 9 doses of rapamycin followed by LiP-MS.
Rapamycin forms a complex with the FK506-binding protein (FKBP12) that
binds and allosterically inhibits mTORC1 (<a href="https://doi.org/10.1016/0092-8674(94)90570-3" class="external-link">Sabatini 1994</a>).
Since rapamycin is known to be a highly specific drug, we expect to
identify FKBP12 as one of the only interacting proteins.</p>
<p>We included 39 random proteins and FKBP12 in this sample data set.
The proteins were sampled using the seed 123.</p>
<p>If you want to read your data into R, we suggest using the
<code><a href="../reference/read_protti.html">read_protti()</a></code> function. This function is a wrapper around
the fast <code>fread()</code> function from the <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a>
package and the <code>clean_names()</code> function from the <a href="https://sfirke.github.io/janitor/" class="external-link"><code>janitor</code></a>
package. This will allow you to not only load your data into R very
fast, but also to clean up the column names into lower snake case. This
will make it easier to remember them and to use them in your data
analysis. To ensure that your data input has the right format you can
check out our <a href="https://jpquast.github.io/protti/articles/input_preparation_workflow.html" class="external-link">input
preparation vignette</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="va">rapamycin_dose_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span><span class="st">"your_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>In this example the rapamycin dose-response data set is included in
protti and you can easily use it by calling the <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>
function. This will load the data into your R session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"rapamycin_dose_response"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cleaning-data">Cleaning data<a class="anchor" aria-label="anchor" href="#cleaning-data"></a>
</h3>
<p>After loading data into R we would like to clean it up to remove rows
that are problematic for our analysis. The
<code>rapamycin_dose_response</code> data is based on a report from <a href="https://biognosys.com/software/spectronaut/" class="external-link">Spectronaut™</a>. It
includes convenient columns that label peptides as being decoys
(<code>eg_is_decoy</code>). Other software reports might have similar
columns that should be checked. MaxQuant for example includes
information on contaminating proteins that you should remove prior to
data analysis. In this case we would like to remove any peptides left in
the report that are decoys (used for false discovery rate estimation).
It is a good practice to just run this even though decoys are usually
already filtered out.</p>
<p>Due to the fact that with increasing raw intensities
(<code>fg_quantity</code>) also variances increase, statistical tests
would have a bias towards lower intense peptides or proteins. Therefore
you should log2 transform your data to correct for this mean-variance
relationship. We do this by using <code>dplyr</code>’s
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> together with <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2()</a></code>.</p>
<p>In addition to filtering and log2 transformation it is also advised
to normalise your data to equal out small differences in overall sample
intensities that result from unequal sample concentrations.
<strong>protti</strong> provides the <code><a href="../reference/normalise.html">normalise()</a></code> function
for this purpose. For this example we will use median normalisation
(<code>method = "median"</code>). This function generates an additional
column called <code>normalised_intensity_log2</code> that contains the
normalised intensities.</p>
<p><em>Note: If your search tool already normalised your data you should
not normalise it again.</em></p>
<p>In addition to the removal of decoys we also remove any
non-proteotypic peptides (<code>pep_is_proteotypic</code>) from our
analysis. This is specific for the analysis of LiP-MS data. If a peptide
is non-proteotypic it is part of two or more proteins. If we detect a
change in non-proteotypic peptides it is not possible to clearly assign
which of the proteins it is coming from.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter, log2 transform and normalise data</span></span>
<span><span class="va">data_normalised</span> <span class="op">&lt;-</span> <span class="va">rapamycin_dose_response</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">eg_is_decoy</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>intensity_log2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">fg_quantity</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">r_file_name</span>,</span>
<span>    intensity_log2 <span class="op">=</span> <span class="va">intensity_log2</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"median"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pep_is_proteotypic</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>It is also useful to check the intensity distribution of all
precursors with the <strong>protti</strong> function
<code><a href="../reference/qc_intensity_distribution.html">qc_intensity_distribution()</a></code>. Usually, the distribution of
intensities is a skewed normal distribution of values missing on the
left flank. This is due to the detection limit of the mass spectrometer.
The probability of not observing a value gets higher with decreasing
intensities.</p>
<p>For experiments measured in data independent acquisition (DIA) mode,
it is good to filter out very low intensity values that are not part of
the distribution. These values are likely false assignments of peaks. If
you look closely you can see a small peak around 0 corresponding to
these values. In the case of our distribution we could chose a cutoff at
a log2 intensity of 5, which corresponds to a raw intensity of 32.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qc_intensity_distribution.html">qc_intensity_distribution</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_normalised</span>,</span>
<span>  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>  intensity <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>  plot_style <span class="op">=</span> <span class="st">"histogram"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="data_analysis_dose_response_workflow_files/figure-html/intensity_distribution-1.png" class="r-plt" alt="" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_normalised</span> <span class="op">&lt;-</span> <span class="va">data_normalised</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">normalised_intensity_log2</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clustering-of-samples">Clustering of samples<a class="anchor" aria-label="anchor" href="#clustering-of-samples"></a>
</h3>
<p>Before we fit dose-response models to our data, we can check how
samples cluster. Ideally, samples that belong to the same treatment
concentration cluster together. A common way that you can analyse this
is correlation based hierachical clustering using the
<code><a href="../reference/qc_sample_correlation.html">qc_sample_correlation()</a></code> function from
<strong>protti</strong>. The correlation of samples is calculated based
on the correlation of precursor (or peptide/protein) intensities. By
default <code><a href="../reference/qc_sample_correlation.html">qc_sample_correlation()</a></code> uses Spearman correlation,
however you can change that to any correlation supported by the
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code> function.</p>
<p><em>Note: Many of <strong>protti</strong>’s plotting functions also
have the option to display an interactive version of the plot with an
<code>interactive</code> argument.</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qc_sample_correlation.html">qc_sample_correlation</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_normalised</span>,</span>
<span>  sample <span class="op">=</span> <span class="va">r_file_name</span>,</span>
<span>  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>  intensity_log2 <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>  condition <span class="op">=</span> <span class="va">r_condition</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="data_analysis_dose_response_workflow_files/figure-html/sample_correlation-1.png" class="r-plt" alt="" width="672" style="display: block; margin: auto;"></p>
<p>For our rapamycin data set we cannot identify any clear sample
clustering based on correlation, because only a small subset of proteins
was selected for this example. Furthermore, data sets in which only a
few changes are expected commonly do not cluster nicely. This is because
precursors/peptides/proteins have very similar intensity values across
conditions and clustering is in this case based on variance. In case of
more global changes samples should usually cluster nicely.</p>
<p>In addition to correlation based clustering a principal component
analysis can be performed using the <strong>protti</strong> function
<code><a href="../reference/qc_pca.html">qc_pca()</a></code>. Similar to before, good clustering is usually
dependent on the amount of changing precursors (or
peptides/proteins).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qc_pca.html">qc_pca</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_normalised</span>,</span>
<span>  sample <span class="op">=</span> <span class="va">r_file_name</span>,</span>
<span>  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>  intensity <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>  condition <span class="op">=</span> <span class="va">r_condition</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="data_analysis_dose_response_workflow_files/figure-html/sample_pca-1.png" class="r-plt" alt="" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="fitting-dose-response-curves">Fitting dose-response curves<a class="anchor" aria-label="anchor" href="#fitting-dose-response-curves"></a>
</h2>
<p>The main part of a dose-response data analysis is the
<code><a href="../reference/fit_drc_4p.html">fit_drc_4p()</a></code> function. It fits four-parameter log-logistic
dose-response curves for every precursor (or peptide/protein) with the
following equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>d</mi><mo>+</mo><mfrac><mrow><mi>a</mi><mo>−</mo><mi>d</mi></mrow><mrow><mn>1</mn><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>x</mi><mi>c</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>b</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">y = d + \frac{a - d}{1 + (\frac{x}{c})^{-b}}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is the dependent variable<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
is the independen variable<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the minimum value that can be obtained<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is the maximum value that can be obtained<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is the point of inflection<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the Hill’s coefficient (e.g. the negative slope at the inflection
point)</p>
<p>The output of <code><a href="../reference/fit_drc_4p.html">fit_drc_4p()</a></code> provides extensive
information on the goodness of fit. Furthermore, the function filters
and ranks fits based on several criteria which include completeness of
data and a significance cutoff based on an adjusted p-value obtained
from ANOVA. For details about the filtering steps you can read the
function documentation by calling <code><a href="../reference/fit_drc_4p.html">?fit_drc_4p</a></code>. If you only
care about your potential hits (and exclude precursors/peptides/proteins
that do not pass the filtering e.g. due to too few observations), you
can choose <code>filter = "pre"</code>, which filters the data before
model fitting. This speeds up the process because less models need to be
fit. If you want to perform enrichment analysis later on you should keep
the default <code>filter = "post"</code>. This will fit all possible
models and then only annotate models based on whether they passed or
failed the filtering step (<code>passed_filter</code>).</p>
<p>Since <strong>protti</strong> version <code>0.8.0</code> we recommend
you use the <code>n_replicate_completeness</code> and
<code>n_condition_completeness</code> arguments in order to define
cutoffs for completeness of replicates in a given number of conditions.
This makes the output of the function reproducible independent of the
input data. With the provided cutoffs below we define that at least 2
replicates need to be detected in 4 conditions. Any precursor with less
completeness than that will not be considered and removed from the
data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">data_normalised</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/fit_drc_4p.html">fit_drc_4p</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">r_file_name</span>,</span>
<span>    grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>    response <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>    dose <span class="op">=</span> <span class="va">r_condition</span>,</span>
<span>    filter <span class="op">=</span> <span class="st">"post"</span>,</span>
<span>    n_replicate_completeness <span class="op">=</span> <span class="fl">2</span>, <span class="co"># specifiy this based on your data and cutoff criteria</span></span>
<span>    n_condition_completeness <span class="op">=</span> <span class="fl">4</span>, <span class="co"># specifiy this based on your data and cutoff criteria</span></span>
<span>    retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># make sure to retain columns that you need later but that are not part of the function</span></span></code></pre></div>
<p>If you have to fit many models this function may take about an hour
or longer. If you have the computational resources you can speed this up
by using <code><a href="../reference/parallel_fit_drc_4p.html">parallel_fit_drc_4p()</a></code>, a parallelised version of
this function.</p>
<p><em>Note: Keep in mind that by spreading the model fitting over
multiple cores, more memory than usual is needed. Furthermore, using the
maximal number of available cores may not be the most efficient, because
it takes time to copy the data to and from each core - this process will
not be performed in parallel. Therefore, it is advised that the run time
on each core is at least as long as the time to set up (data transfer,
environment preparation etc.) all cores.</em></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># setup of cores. Make sure you have the future package installed</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit models in parallel</span></span>
<span><span class="va">parallel_fit</span> <span class="op">&lt;-</span> <span class="va">data_normalised</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/parallel_fit_drc_4p.html">parallel_fit_drc_4p</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">r_file_name</span>,</span>
<span>    grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>    response <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>    dose <span class="op">=</span> <span class="va">r_condition</span>,</span>
<span>    retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span><span class="op">)</span>,</span>
<span>    n_cores <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    n_replicate_completeness <span class="op">=</span> <span class="fl">2</span>, <span class="co"># specifiy this based on your data and cutoff criteria</span></span>
<span>    n_condition_completeness <span class="op">=</span> <span class="fl">4</span>, <span class="co"># specifiy this based on your data and cutoff criteria</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># remove workers again after you are done</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/sequential.html" class="external-link">sequential</a></span><span class="op">)</span></span></code></pre></div>
<p>If we examine all precursors based on their rank (calculated from
correlation and ANOVA q-value), we can see that as expected most of them
are FKBP12 (P62942) peptides. One benefit of analysing LiP-MS data on
the precursor level (rather than peptide level) is that multiple lines
of evidence for a change in the specific peptide can be used (we have
data for each different charge and modification state). Therefore, it is
always good to check if there are other precursors of a good scoring
peptide that do not show any regulation at all. This would mean that the
reason for the observed response is not based on a biological
effect.</p>
<table style="width:100%;" class="table">
<caption>All hits</caption>
<colgroup>
<col width="3%">
<col width="4%">
<col width="46%">
<col width="17%">
<col width="11%">
<col width="9%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="right">rank</th>
<th align="left">score</th>
<th align="left">eg_precursor_id</th>
<th align="left">pg_protein_accessions</th>
<th align="left">anova_adj_pval</th>
<th align="left">correlation</th>
<th align="left">ec_50</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">0.912</td>
<td align="left">
<em>RGQTC[Carbamidomethyl (C)]VVHYTGMLEDGK</em>.3</td>
<td align="left">P62942</td>
<td align="left">4.73e-14</td>
<td align="left">0.948</td>
<td align="left">3.2e+05</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">0.885</td>
<td align="left">
<em>GWEEGVAQMSVGQR</em>.2</td>
<td align="left">P62942</td>
<td align="left">1.08e-13</td>
<td align="left">0.947</td>
<td align="left">4.7e+05</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">0.884</td>
<td align="left">
<em>VFDVELLKLE</em>.2</td>
<td align="left">P62942</td>
<td align="left">2.26e-12</td>
<td align="left">0.967</td>
<td align="left">3.6e+06</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">0.797</td>
<td align="left">
<em>LVFDVELLK</em>.2</td>
<td align="left">P62942</td>
<td align="left">7.20e-11</td>
<td align="left">0.959</td>
<td align="left">4.4e+06</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">0.783</td>
<td align="left">
<em>GWEEGVAQ</em>.1</td>
<td align="left">P62942</td>
<td align="left">2.55e-09</td>
<td align="left">0.976</td>
<td align="left">7.8e+06</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">0.770</td>
<td align="left">
<em>RGQTC[Carbamidomethyl (C)]VVHYTGMLEDGK</em>.4</td>
<td align="left">P62942</td>
<td align="left">1.40e-12</td>
<td align="left">0.926</td>
<td align="left">5.7e+05</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">0.703</td>
<td align="left">
<em>YTGMLEDGK</em>.2</td>
<td align="left">P62942</td>
<td align="left">1.32e-09</td>
<td align="left">0.945</td>
<td align="left">3.5e+06</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">0.692</td>
<td align="left">
<em>RGQTC[Carbamidomethyl (C)]VVH</em>.2</td>
<td align="left">P62942</td>
<td align="left">1.45e-09</td>
<td align="left">0.943</td>
<td align="left">7.7e+06</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">0.681</td>
<td align="left">
<em>GWEEGVAQMSVGQR</em>.3</td>
<td align="left">P62942</td>
<td align="left">2.67e-09</td>
<td align="left">0.944</td>
<td align="left">7.7e+05</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">0.673</td>
<td align="left">
<em>LTISPDYAYGAT</em>.2</td>
<td align="left">P62942</td>
<td align="left">5.22e-09</td>
<td align="left">0.946</td>
<td align="left">3.0e+06</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">0.621</td>
<td align="left">
<em>LVFDVELLKLE</em>.2</td>
<td align="left">P62942</td>
<td align="left">1.30e-08</td>
<td align="left">0.934</td>
<td align="left">5.2e+06</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">0.491</td>
<td align="left">
<em>VVHYTGMLEDGK</em>.3</td>
<td align="left">P62942</td>
<td align="left">4.25e-08</td>
<td align="left">0.900</td>
<td align="left">6.7e+06</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">0.449</td>
<td align="left">
<em>RGQTC[Carbamidomethyl (C)]VVHYTGM[Oxidation
(M)]LEDGK</em>.3</td>
<td align="left">P62942</td>
<td align="left">9.10e-03</td>
<td align="left">0.954</td>
<td align="left">1.2e+06</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">0.436</td>
<td align="left">
<em>VFDVELLK</em>.2</td>
<td align="left">P62942</td>
<td align="left">4.70e-06</td>
<td align="left">0.908</td>
<td align="left">3.1e+06</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">0.366</td>
<td align="left">
<em>VVHYTGMLEDGK</em>.2</td>
<td align="left">P62942</td>
<td align="left">1.63e-06</td>
<td align="left">0.880</td>
<td align="left">7.4e+06</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">0.154</td>
<td align="left">
<em>GWEEGVAQM</em>.2</td>
<td align="left">P62942</td>
<td align="left">4.14e-04</td>
<td align="left">0.843</td>
<td align="left">1.6e+06</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="left">0.132</td>
<td align="left">
<em>DTVATQLSEAVDATR</em>.2</td>
<td align="left">O60664</td>
<td align="left">5.80e-04</td>
<td align="left">0.838</td>
<td align="left">4.8e+07</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">0.000</td>
<td align="left">
<em>DYFEEYGKIDTIEIITDR</em>.3</td>
<td align="left">P22626</td>
<td align="left">2.27e-02</td>
<td align="left">0.816</td>
<td align="left">3.2e+07</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="model-fit-plotting">Model fit plotting<a class="anchor" aria-label="anchor" href="#model-fit-plotting"></a>
</h3>
<p>After model fitting, you can easily visualise model fits by plotting
them with the <code><a href="../reference/drc_4p_plot.html">drc_4p_plot()</a></code> function. You can provide one
or more precursor IDs to the <code>targets</code> argument or just
return plots for all precursors with <code>targets = "all"</code>. Make
sure that the number of plots is reasonable to return within R. You can
also directly export your plots by setting
<code>export = TRUE</code>.</p>
<p><em>Note: The output of <code><a href="../reference/fit_drc_4p.html">fit_drc_4p()</a></code> includes two
columns with data frames containing the model and original data points
required for the plot. These data frames contain the original names for
<code>dose</code> and <code>response</code> that you provided to
<code><a href="../reference/fit_drc_4p.html">fit_drc_4p()</a></code>.</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model plotting</span></span>
<span><span class="fu"><a href="../reference/drc_4p_plot.html">drc_4p_plot</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,</span>
<span>  dose <span class="op">=</span> <span class="va">r_condition</span>,</span>
<span>  response <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>  targets <span class="op">=</span> <span class="st">"_VFDVELLKLE_.2"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"pM"</span>,</span>
<span>  x_axis_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1e+08</span><span class="op">)</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $`_VFDVELLKLE_.2 (correlation = 0.97, EC50 = 3601983)`</span></span></code></pre></div>
<p><img src="data_analysis_dose_response_workflow_files/figure-html/model_plot-1.png" class="r-plt" alt="" width="672" style="display: block; margin: auto;"></p>
<p>There are additional arguments that help you customise your plot. You
can for example specify the axis limits with <code>x_axis_limits</code>.
This should generally always be set to the lowest non-zero and highest
concentration <code>x_axis_limits = c(10, 1e+08)</code>. Like this you
can more easily see if extreme concentrations are completely missing
from the curve. The <code>colours</code> argument allows you to specify
your own colours for the points, confidence interval and curve.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-analysis">Further analysis<a class="anchor" aria-label="anchor" href="#further-analysis"></a>
</h2>
<p>After models are fit, you can have a deeper look into the hits you
obtained. <strong>protti</strong> provides several functions that help
you to identify patterns in your data.</p>
<p>You can test your data set for gene ontology (GO) term enrichment
(<code><a href="../reference/calculate_go_enrichment.html">calculate_go_enrichment()</a></code>). Alternatively, pathway
annotations provided in the KEGG database can be used to test for
pathway enrichments (<code><a href="../reference/calculate_kegg_enrichment.html">calculate_kegg_enrichment()</a></code>).</p>
<p>If you know which proteins bind or interact with your specific
treatment, you can provide your own list of true positive hits and check
if these are enriched in your significant hits by using
<strong>protti</strong>’s <code><a href="../reference/calculate_treatment_enrichment.html">calculate_treatment_enrichment()</a></code>
function. For our LiP-MS experiment using rapamycin we are probing
direct interaction with proteins in contrast to functional effects. The
only protein that rapamycin is known to bind to is FKBP12 and testing
the significance of enrichment for a single or even a few proteins is
not appropriate. However, testing for enrichment is especially useful if
your treatment affects many proteins, since it can help you to reduce
the complexity of your result.</p>
<p>The <a href="https://doi.org/10.1093/nar/gky1131" class="external-link">STRING</a> database
provides a good resource for the analysis of protein interaction
networks. It is often very useful to check for interactions within your
significant hits. For LiP-MS data this sometimes explains why proteins
that do not directly interact with your treatment are still
significantly affected. With <code><a href="../reference/analyse_functional_network.html">analyse_functional_network()</a></code>,
<strong>protti</strong> provides a useful wrapper around some <a href="https://www.bioconductor.org/packages/release/bioc/html/STRINGdb.html" class="external-link"><code>STRINGdb</code></a>
package functions.</p>
<div class="section level3">
<h3 id="annotation-of-data">Annotation of data<a class="anchor" aria-label="anchor" href="#annotation-of-data"></a>
</h3>
<p><strong>protti</strong> has several functions for fetching database
information. One commonly used database in the proteomics community is
UniProt. By providing the <code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code> function with a
character vector of your protein IDs, you can fetch additional
information about the proteins. These include names, IDs from other
databases, gene ontology annotations, information about the active
metabolite and metal binding sites, protein length and sequence. You can
freely select which information you are most interested in by providing
it to the <code>columns</code> arguments of the
<code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code> function based on the information they <a href="https://www.uniprot.org/help/return_fields" class="external-link">provide</a> for
download.</p>
<p>Furthermore, we will add a <code>passed_filter</code> column to the
data that contains TRUE or FALSE information based on if a precursor
passed the filtering criterion defined in the <code><a href="../reference/fit_drc_4p.html">fit_drc_4p()</a></code>
function. This is the case if the peptide was assigned a rank.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fetching of UniProt information</span></span>
<span><span class="va">unis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">pg_protein_accessions</span><span class="op">)</span></span>
<span><span class="va">uniprot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_uniprot.html">fetch_uniprot</a></span><span class="op">(</span><span class="va">unis</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># annotation of fit data based on information from UniProt</span></span>
<span><span class="va">fit_annotated</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># columns containing proteins IDs are named differently</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">uniprot</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pg_protein_accessions"</span> <span class="op">=</span> <span class="st">"accession"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># mark peptides that pass the filtering</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>passed_filter <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rank</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># create new column with prior knowledge about binding partners of treatment</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>binds_treatment <span class="op">=</span> <span class="va">pg_protein_accessions</span> <span class="op">==</span> <span class="st">"P62942"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="enrichment-and-network-analysis">Enrichment and network analysis<a class="anchor" aria-label="anchor" href="#enrichment-and-network-analysis"></a>
</h3>
<p>As mentioned earlier, for our test data set, enrichment or network
analysis are not useful, since we only use a very small random subset of
the complete data set and rapamycin only interacts with FKBP12.</p>
<p>Nevertheless, we will demonstrate below how you could use some
additional functions on your own data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### GO enrichment using "molecular function" annotation from UniProt</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_go_enrichment.html">calculate_go_enrichment</a></span><span class="op">(</span><span class="va">fit_annotated</span>,</span>
<span>  protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,</span>
<span>  is_significant <span class="op">=</span> <span class="va">passed_filter</span>,</span>
<span>  go_annotations_uniprot <span class="op">=</span> <span class="va">go_f</span></span>
<span><span class="op">)</span> <span class="co"># column obtained from UniProt</span></span>
<span></span>
<span><span class="co">### KEGG pathway enrichment</span></span>
<span></span>
<span><span class="co"># First you need to load KEGG pathway annotations from the KEGG database</span></span>
<span><span class="co"># for your specific organism of interest. In this case HeLa cells were</span></span>
<span><span class="co"># used, therefore the organism of interest is homo sapiens (hsa)</span></span>
<span></span>
<span><span class="va">kegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_kegg.html">fetch_kegg</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"hsa"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Next we need to annotate our data with KEGG pathway IDs and perform enrichment analysis</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># columns containing proteins IDs are named differently</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">kegg</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pg_protein_accessions"</span> <span class="op">=</span> <span class="st">"uniprot_id"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate_kegg_enrichment.html">calculate_kegg_enrichment</a></span><span class="op">(</span></span>
<span>    protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,</span>
<span>    is_significant <span class="op">=</span> <span class="va">passed_filter</span>,</span>
<span>    pathway_id <span class="op">=</span> <span class="va">pathway_id</span>, <span class="co"># column name from kegg data frame</span></span>
<span>    pathway_name <span class="op">=</span> <span class="va">pathway_name</span></span>
<span>  <span class="op">)</span> <span class="co"># column name from kegg data frame</span></span>
<span></span>
<span><span class="co">### Treatment enrichment analysis</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_treatment_enrichment.html">calculate_treatment_enrichment</a></span><span class="op">(</span><span class="va">fit_annotated</span>,</span>
<span>  protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,</span>
<span>  is_significant <span class="op">=</span> <span class="va">passed_filter</span>,</span>
<span>  binds_treatment <span class="op">=</span> <span class="va">binds_treatment</span>,</span>
<span>  treatment_name <span class="op">=</span> <span class="st">"Rapamycin"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Network analysis</span></span>
<span></span>
<span><span class="va">fit_annotated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">passed_filter</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># only analyse hits that were significant</span></span>
<span>  <span class="fu"><a href="../reference/analyse_functional_network.html">analyse_functional_network</a></span><span class="op">(</span></span>
<span>    protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,</span>
<span>    string_id <span class="op">=</span> <span class="va">xref_string</span>, <span class="co"># column from UniProt containing STRING IDs</span></span>
<span>    organism_id <span class="op">=</span> <span class="fl">9606</span>,</span>
<span>    <span class="co"># tax ID can be found in function documentation or STRING database</span></span>
<span>    binds_treatment <span class="op">=</span> <span class="va">binds_treatment</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
