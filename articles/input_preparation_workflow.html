<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Input Preparation Workflow • protti</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Input Preparation Workflow">
<meta property="og:description" content="protti">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/protein_structure_workflow.html">Protein Structure Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="input_preparation_workflow_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Input Preparation Workflow</h1>
                        <h4 data-toc-skip class="author">Dina Schuster</h4>
            
            <h4 data-toc-skip class="date">2022-03-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/HEAD/vignettes/input_preparation_workflow.Rmd" class="external-link"><code>vignettes/input_preparation_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>input_preparation_workflow.Rmd</code></div>

    </div>

    
    
<style>
  body {
    text-align: justify}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will give you an overview of how you can prepare the quantitative protein/peptide matrix output from common search engines and software such as <a href="https://biognosys.com/software/spectronaut/" class="external-link">Spectronaut</a>, MaxQuant, <a href="https://www.thermofisher.com/order/catalog/product/OPTON-30945" class="external-link">Proteome Discoverer</a> and <a href="https://skyline.ms/project/home/software/Skyline/begin.view" class="external-link">Skyline</a> for the analysis with <strong>protti</strong>. Due to its modular and flexible structure <strong>protti</strong> can be used on the output of common bottom-up proteomics search engines irrespective of the measurement mode (DDA, DIA, targeted-MS).</p>
<p>Furthermore, you are not only restricted to reports from the above mentioned search engines. As long as your data has a tabular format (data frame) and a specific minimal number of data columns you can analyse it with <strong>protti</strong>. The columns minimally required contain information on sample, condition, intensity, protein ID and the level the intensity is based on (fragment, precursor, peptide) if different from protein intensity. Depending on the analysis many more columns can be useful, but they are not required. Ultimately, your data should have a structure similar to this:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Sample</th>
<th align="center">Protein ID</th>
<th align="center">Peptide Sequence</th>
<th align="center">Condition</th>
<th align="center">Intensity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">sample1</td>
<td align="center">P62942</td>
<td align="center">PEPTIDER</td>
<td align="center">treated</td>
<td align="center">14000</td>
</tr>
<tr class="even">
<td align="center">sample2</td>
<td align="center">P62942</td>
<td align="center">PEPTI</td>
<td align="center">treated</td>
<td align="center">15000</td>
</tr>
<tr class="odd">
<td align="center">sample3</td>
<td align="center">P62942</td>
<td align="center">PEPTIDE</td>
<td align="center">treated</td>
<td align="center">14500</td>
</tr>
<tr class="even">
<td align="center">sample4</td>
<td align="center">P62942</td>
<td align="center">PEPTIDER</td>
<td align="center">control</td>
<td align="center">18000</td>
</tr>
<tr class="odd">
<td align="center">sample5</td>
<td align="center">P62942</td>
<td align="center">PEPTI</td>
<td align="center">control</td>
<td align="center">21000</td>
</tr>
<tr class="even">
<td align="center">sample6</td>
<td align="center">P62942</td>
<td align="center">PEPTIDE</td>
<td align="center">control</td>
<td align="center">19000</td>
</tr>
</tbody>
</table>
<p>It is very important, that each unit of the level you perform your analysis on (e.g. peptide) has a single unique intensity associated with it. If, for example, a peptide has two different intensities, <strong>protti</strong> would not know how to deal with this and many functions will likely fail.</p>
<p>Data should always be organised in a format called <a href="https://r4ds.had.co.nz/tidy-data.html" class="external-link">tidy data</a>. That means data should be contained in a long format (e.g. all sample names in one column) rather than a wide format (e.g. each sample name in its own column with intensity as the content of the columns). You can easily achieve this by using the <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> function from the <a href="https://tidyr.tidyverse.org/index.html" class="external-link"><code>tidyr</code></a> package. The output of many search engines already contains tidy data and working with it is very easy because you can refer to information with only one variable. <strong>protti</strong> is designed to work together well with the <a href="https://www.tidyverse.org" class="external-link"><code>tidyverse</code></a> package family that is build around the concept of tidy data.</p>
<div class="section level3">
<h3 id="protein-centric-analysis">Protein-centric analysis<a class="anchor" aria-label="anchor" href="#protein-centric-analysis"></a>
</h3>
<p>Many search engines provide the user with protein intensities. However, it is also possible to calculate protein intensities directly from precursor intensities with the <strong>protti</strong> function <code><a href="../reference/calculate_protein_abundance.html">calculate_protein_abundance()</a></code>.</p>
<p>One advantage of calculating the protein abundance with <strong>protti</strong> is the possibility to median normalise run intensities on the precursor level. This is closer to the actually acquired intensities and thus sample concentrations than if normalisation is performed on the protein level. Some search engines provide the option for automatic median normalisation but not all.</p>
<p>If you prefer to use protein intensities provided by the seach engine of your choice this is not a problem and we will show how some of this information can be converted into the right format.</p>
</div>
<div class="section level3">
<h3 id="loading-packages">Loading packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h3>
<p>We will demonstrate how most outputs can be converted with functions from the R packages <a href="https://magrittr.tidyverse.org/index.html" class="external-link"><code>magrittr</code></a>, <a href="https://dplyr.tidyverse.org/index.html" class="external-link"><code>dplyr</code></a>, <a href="https://tidyr.tidyverse.org/index.html" class="external-link"><code>tidyr</code></a> and <a href="https://stringr.tidyverse.org/" class="external-link"><code>stringr</code></a>. You can load packages after you installed them with the <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></code></pre></div>
<p>Note that we are using the R package <a href="https://magrittr.tidyverse.org/index.html" class="external-link"><code>magrittr</code></a> because of its pipe operator <code>%&gt;%</code>. It takes the output of the preceding function and supplies it as the first argument of the following function. Using <code>%&gt;%</code> makes code easier to read and follow.</p>
</div>
</div>
<div class="section level2">
<h2 id="spectronaut">Spectronaut<a class="anchor" aria-label="anchor" href="#spectronaut"></a>
</h2>
<p>Spectronaut reports already contain data in the tidy data format. Therefore nothing needs to be changed in order to use them with <strong>protti</strong>. However, the columns we would recommend (not all columns are required) to export from Spectronaut are:</p>
<ul>
<li>R.Condition (condition names)</li>
<li>R.FileName (file names)</li>
<li>PG.ProteinAccessions (protein identifiers)</li>
<li>PEP.IsProteotypic (logical indicating if peptide is proteotypic)</li>
<li>PEP.StrippedSequence (peptide sequence)</li>
<li>PEP.NrOfMissedCleavages (number of missed cleavages, relevant for quality control)</li>
<li>EG.IsDecoy (logical indicating if peptide is a decoy match)</li>
<li>EG.PrecursorId (peptide precursor ID)</li>
<li>FG.Quantity (precursor quantity, required for peptide-centric analyses)</li>
<li>FG.Charge (precursor charge state, relevant for quality control)</li>
<li>PG.Quantity (protein group quantity, required for protein-centric analyses if you prefer not to calculate them with <code><a href="../reference/calculate_protein_abundance.html">calculate_protein_abundance()</a></code>)</li>
</ul>
<p>Please make sure that the report is a .csv file. You can use the <code><a href="../reference/read_protti.html">read_protti()</a></code> function in order to load the spectronaut report into R. This function is a wrapper around the fast <code>fread()</code> function from the <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a> package and the <code>clean_names()</code> function from the <a href="http://sfirke.github.io/janitor/" class="external-link"><code>janitor</code></a> package. This will allow you to not only load your data into R very fast, but also to clean up the column names into lower snake case. This will make it easier to remember them and to use them in your data analysis. For the Spectronaut columns <code>R.FileName</code> will change for example into <code>r_file_name</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To read in your own data you can use read_protti()</span>
<span class="va">spectronaut_data</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"mydata/spectronaut.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="maxquant">MaxQuant<a class="anchor" aria-label="anchor" href="#maxquant"></a>
</h2>
<p>Depending on which analysis you are performing you will have to use different outputs. For peptide-centric analyses we would recommend to use the <code>evidence.txt</code> file. If you want to perform a protein-centric analysis and you want to use protein quantities calculated by MaxQuant, you need the <code>proteinGroups.txt</code> file.</p>
<div class="section level3">
<h3 id="peptide-centric-analysislip-ms-analysis">Peptide-centric analysis/LiP-MS analysis<a class="anchor" aria-label="anchor" href="#peptide-centric-analysislip-ms-analysis"></a>
</h3>
<p>In case you are interested in performing a <strong>peptide-centric</strong> analysis (necessary for LiP-MS), you should use the <code>evidence.txt</code> file provided in the search output of MaxQuant.</p>
<p>The <code>evidence.txt</code> file basically contains all the information we need to run <strong>protti</strong>. It is also contained in a long format which makes it easy to read in and use directly. One thing to take into consideration is the lack of a column for information on proteotypicity of peptides. However, this information can be inferred from the <code>Proteins</code> column if it contains more than one protein ID. You can extract this information and create a new column called <code>is_proteotypic</code> containing logicals that will be <code>TRUE</code> if the <code>Proteins</code> column does not contain a semicolon and <code>FALSE</code> if it does (this indicates that the peptide belongs to more than one protein). As mentioned in the data analysis vignettes this information is necessary for the analysis of LiP-MS data but it could be also considered for the correct calculation of protein abundances.</p>
<p>Another column that is required for the analysis of your data is a column indicating conditions to which certain samples belong. This can be easily added to the evidence file by joining a data frame containing the specific annotations. You can create such a data frame in Excel and import it into R for a large number of samples or just create it directly in R.</p>
<p>MaxQuant output provides information on decoy hits contained in the column <code>reverse</code> and also has information on whether your hit is a contaminant <code>potential_contaminant</code>. You should filter these out before the analysis. However, the contaminant column can be used for quality control.</p>
<p>One important thing for MaxQuant data is to <strong>make sure that you only have one intensity assigned to each peptide or precursor.</strong> You can do this by summing up all intensities that MaxQuant exports (these can be MULTI-MSMS, MSMS, ISO-MSMS, MULTI-MATCH, ISO-SECPEP) or you can filter for example for precursors with MULTI-MSMS quantification and only use these.</p>
<p>In this section we will show you how to read in the file with <code><a href="../reference/read_protti.html">read_protti()</a></code> and how to create the <code>is_proteotypic</code> column and the <code>condition</code> column (minimally required) with the help of the <code>stringr</code> and <code>dplyr</code> packages. How to filter your data best is described in the data analysis vignettes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To read in your own data you can use read_protti()</span>
<span class="va">evidence</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"yourpath/evidence.txt"</span><span class="op">)</span>

<span class="va">evidence_proteotypic</span> <span class="op">&lt;-</span> <span class="va">evidence</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># adds new column with logicals that are TRUE if the peptide can be assigned </span>
  <span class="co"># to only one protein and FALSE if it can be assigned to multiple</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_proteotypic <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span>
    string <span class="op">=</span> <span class="va">proteins</span>,
    pattern <span class="op">=</span> <span class="st">";"</span>,
    negate <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># adds new column with logicals indicating if peptide is coming from a potential contaminant</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_contaminant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">potential_contaminant</span> <span class="op">==</span> <span class="st">"+"</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># Make an annotation data frame and merge it with your data frame to obtain conditions</span>
<span class="co"># We are annotating sample 1-3 as controls and samples 4-6 as treated conditions</span>

<span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># make sure that the names are the same name as in your report</span>
  <span class="st">"sample1"</span>,
  <span class="st">"sample2"</span>,
  <span class="st">"sample3"</span>,
  <span class="st">"sample4"</span>,
  <span class="st">"sample5"</span>,
  <span class="st">"sample6"</span>
<span class="op">)</span>

<span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>
<span class="op">)</span>

<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="va">condition</span><span class="op">)</span>

<span class="co"># Combine your long data frame with the annotation</span>
<span class="va">evidence_annotated</span> <span class="op">&lt;-</span> <span class="va">evidence_proteotypic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation</span>, by <span class="op">=</span> <span class="st">"file_name"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="protein-centric-analysis-1">Protein-centric analysis<a class="anchor" aria-label="anchor" href="#protein-centric-analysis-1"></a>
</h3>
<p>For <strong>protein-centric</strong> analyses you can use the <code>proteinGroups.txt</code> file provided by MaxQuant. This file contains information in a wide format where each sample has its own column containing intensity values. Therefore, we need to transform this data into a long format to meet the conditions of tidy data.</p>
<p>We will filter the data and use <code>tidyr</code>’s <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer()</a></code> to change the format to long format. Furthermore, we produce an annotation data frame to create a <code>conditions</code> column. The filtering is only done in order to remove proteins with potentially low quality. Further filtering for decoys and potential contaminants should be performed based on the data analysis vignettes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To read in your own data you can use read_protti()</span>
<span class="va">protein_groups</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"yourpath/proteinGroups.txt"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># adds new column with logicals indicating if protein is a potential contaminant, </span>
  <span class="co"># you can filter these out later on. You should also consider filtering out proteins </span>
  <span class="co"># that were "only identified by site" and reverse hits, as well as proteins with only </span>
  <span class="co"># one identified peptide</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_potential_contaminant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">potential_contaminant</span> <span class="op">==</span> <span class="st">"+"</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># Change wide format to long format and create new columns called `r_file_name`and `intensity`</span>
<span class="va">protein_groups_long</span> <span class="op">&lt;-</span> <span class="va">protein_groups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"intensity_"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"file_name"</span>,
    values_to <span class="op">=</span> <span class="st">"intensity"</span>
  <span class="op">)</span>

<span class="co"># Make an annotation data frame and merge it with your data frame to obtain conditions</span>
<span class="co"># We are annotating sample 1-3 as controls and samples 4-6 as treated conditions</span>

<span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># make sure that the names are the same name as in your report</span>
  <span class="st">"intensity_sample1"</span>,
  <span class="st">"intensity_sample2"</span>,
  <span class="st">"intensity_sample3"</span>,
  <span class="st">"intensity_sample4"</span>,
  <span class="st">"intensity_sample5"</span>,
  <span class="st">"intensity_sample6"</span>
<span class="op">)</span>

<span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>
<span class="op">)</span>

<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="va">condition</span><span class="op">)</span>

<span class="co"># Combine your long data frame with the annotation</span>
<span class="va">protein_groups_annotated</span> <span class="op">&lt;-</span> <span class="va">protein_groups_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation</span>, by <span class="op">=</span> <span class="st">"file_name"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="skyline">Skyline<a class="anchor" aria-label="anchor" href="#skyline"></a>
</h2>
<p>The Skyline output is already in long format, however, to process it you need to sum up the transition intensities to obtain the intensity of one precursor. If you prefer to analyse your data on the fragment level, you should create a column that uniquely identifies each fragment of each precursor. You could do that by pasting together the peptide sequence with the charge and the product m/z.</p>
<p>The required Skyline output columns include:</p>
<ul>
<li>Peptide Sequence</li>
<li>Protein Name</li>
<li>Replicate Name</li>
<li>Precursor Charge</li>
<li>Product Mz (we are exporting these to distinguish transitions)</li>
<li>Area (or Intensity, depending on what you prefer to use)</li>
</ul>
<p>You can add replicate and condition annotations in Skyline directly. However, we will explain in this section how you can also do it in R. If you want to analyse your data on the protein abundance level you will have to combine the precursor intensities to obtain one value for protein abundance. This could be done using the <code><a href="../reference/calculate_protein_abundance.html">calculate_protein_abundance()</a></code> function from <strong>protti</strong>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load data</span>
<span class="va">skyline_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"yourpath/skyline.csv"</span><span class="op">)</span>

<span class="va">skyline_data_int</span> <span class="op">&lt;-</span> <span class="va">skyline_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># create a column with precursor information</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>precursor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">peptide_sequence</span>, <span class="st">"_"</span>, <span class="va">charge</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">replicate_name</span>, <span class="va">precursor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># making a new column containing the summed up intensities of all transitions of one precursor</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sum_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">product_mz</span>, <span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># removing the columns we don't need</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removing duplicated rows from the data frame</span>

<span class="co"># Add annotation</span>
<span class="co"># make sure that the names are the same name as in your report</span>
<span class="va">replicate_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> 
  <span class="st">"sample_1"</span>, 
  <span class="st">"sample_2"</span>,
  <span class="st">"sample_3"</span>,
  <span class="st">"sample_1"</span>,
  <span class="st">"sample_2"</span>,
  <span class="st">"sample_3"</span>
<span class="op">)</span>

<span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>
<span class="op">)</span>

<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">replicate_name</span>, <span class="va">condition</span><span class="op">)</span>

<span class="co"># Combine your long data frame with the annotation</span>
<span class="va">skyline_annotated</span> <span class="op">&lt;-</span> <span class="va">skyline_data_int</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation</span>, by <span class="op">=</span> <span class="st">"replicate_name"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="proteome-discoverer">Proteome Discoverer<a class="anchor" aria-label="anchor" href="#proteome-discoverer"></a>
</h2>
<p>The Proteome Discoverer output contains data in wide format (one column for each sample). Similar to MaxQuant there is also the option for a peptide or a protein-centric export. We will discuss both cases in this segment.</p>
<div class="section level3">
<h3 id="peptide-centric-analysislip-ms-analysis-1">Peptide-centric analysis/LiP-MS analysis<a class="anchor" aria-label="anchor" href="#peptide-centric-analysislip-ms-analysis-1"></a>
</h3>
<p>For a <strong>peptide-centric</strong> or a LiP-MS analysis please export the “Peptide Groups” report. Before preparing your export you can add the column “sequence” to your table otherwise Proteome Discoverer will only export the “annotated sequence” column which includes the preceding and following amino acids in the protein sequence.</p>
<p>The required columns include:</p>
<ul>
<li>Sequence</li>
<li>Modifications</li>
<li>Number Proteins</li>
<li>Contaminant</li>
<li>Master Protein Accessions</li>
<li>Abundance or normalized abundance columns</li>
<li>Quan Info</li>
</ul>
<p>After saving the report as an Excel file please convert it to a .csv file, simply by opening it and saving it as such.</p>
<p>We will read in the file using <code><a href="../reference/read_protti.html">read_protti()</a></code> and then select the columns we are interested in. You can use the <code>contaminant</code> column for qualitiy control. The <code>number_proteins</code> column contains information on the proteotypicity. If this is 1 then the peptide is proteotypic. If you want to analyse your data qualitatively only with quality control functions of <strong>protti</strong> you can keep peptides without quantifications. Before you start your quantitative analysis remove observations that are labeled <code>"No Quan Values"</code> in the <code>quan_info</code> column. In the below example they are filtered out at this step, but you can keep them and only filter them out later.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load data</span>
<span class="va">pd_pep_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span><span class="st">"yourpath/PDpeptides.csv"</span><span class="op">)</span>

<span class="co"># Select relevant columns</span>
<span class="va">pd_pep_selected</span> <span class="op">&lt;-</span> <span class="va">pd_pep_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>
    <span class="va">sequence</span>,
    <span class="va">modifications</span>,
    <span class="va">number_proteins</span>,
    <span class="va">contaminant</span>,
    <span class="va">master_protein_accessions</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"abundances_grouped"</span><span class="op">)</span>, <span class="co"># select all columns that start with "abundances_grouped"</span>
    <span class="va">quan_info</span>
  <span class="op">)</span>

<span class="co"># Filter data frame</span>
<span class="va">pd_pep_filtered</span> <span class="op">&lt;-</span> <span class="va">pd_pep_selected</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contaminant</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># remove annotated contaminants</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">number_proteins</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># select proteotypic peptides</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">quan_info</span> <span class="op">!=</span> <span class="st">"No Quan Values"</span><span class="op">)</span> <span class="co"># remove peptides that have no quantification values</span>

<span class="co"># Convert into long format</span>
<span class="va">pd_pep_long</span> <span class="op">&lt;-</span> <span class="va">pd_pep_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"abundances"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"file_name"</span>,
    values_to <span class="op">=</span> <span class="st">"intensity"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># combine peptide sequence and modifications to make a precursor column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>precursor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">sequence</span>, <span class="va">modifications</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># Make annotation data frame</span>
<span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># make sure that the names are the same name as in your report</span>
  <span class="st">"abundances_grouped_f1"</span>,
  <span class="st">"abundances_grouped_f2"</span>,
  <span class="st">"abundances_grouped_f3"</span>,
  <span class="st">"abundances_grouped_f4"</span>,
  <span class="st">"abundances_grouped_f5"</span>,
  <span class="st">"abundances_grouped_f6"</span>
<span class="op">)</span>

<span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>
<span class="op">)</span>

<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="va">condition</span><span class="op">)</span>

<span class="co"># Combine your long data frame with the annotation</span>
<span class="va">pd_pep_long_annotated</span> <span class="op">&lt;-</span> <span class="va">pd_pep_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation</span>, by <span class="op">=</span> <span class="st">"file_name"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="protein-centric-analysis-2">Protein-centric analysis<a class="anchor" aria-label="anchor" href="#protein-centric-analysis-2"></a>
</h3>
<p>For a <strong>protein-centric</strong> or analysis please export the “Proteins” report.</p>
<p>The required columns include:</p>
<ul>
<li>Accession</li>
<li>Description</li>
<li>Contaminant</li>
<li>Number Peptides</li>
<li>Abundance or normalized abundance columns</li>
</ul>
<p>After saving the report as an Excel file please convert it to a .csv file, simply by opening it and saving it as such.</p>
<p>We will read in the file using <code><a href="../reference/read_protti.html">read_protti()</a></code> and then select the columns we are interested in. Similar to above you can either filter the <code>contaminant</code> and <code>number_peptides</code> columns now or later.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load data</span>
<span class="va">pd_prot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span><span class="st">"yourpath/PDproteins.csv"</span><span class="op">)</span>

<span class="co"># Select relevant columns</span>
<span class="va">pd_prot_selected</span> <span class="op">&lt;-</span> <span class="va">pd_prot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>
    <span class="va">accession</span>,
    <span class="va">description</span>,
    <span class="va">contaminant</span>,
    <span class="va">number_peptides</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"abundances_grouped"</span><span class="op">)</span>, <span class="co"># select all columns that start with "abundances_grouped"</span>
  <span class="op">)</span>

<span class="co"># Filter data frame</span>
<span class="va">pd_prot_data_filtered</span> <span class="op">&lt;-</span> <span class="va">pd_prot_selected</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contaminant</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># remove annotated contaminants</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">number_peptides</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># select proteins with more than one identified peptide</span>

<span class="co"># Convert into long format</span>
<span class="va">pd_prot_long</span> <span class="op">&lt;-</span> <span class="va">pd_prot_data_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"abundances"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"file_name"</span>,
    values_to <span class="op">=</span> <span class="st">"intensity"</span>
  <span class="op">)</span>

<span class="co"># Make annotation data frame</span>
<span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># make sure that the names are the same name as in your report</span>
  <span class="st">"abundances_grouped_f1"</span>,
  <span class="st">"abundances_grouped_f2"</span>,
  <span class="st">"abundances_grouped_f3"</span>,
  <span class="st">"abundances_grouped_f4"</span>,
  <span class="st">"abundances_grouped_f5"</span>,
  <span class="st">"abundances_grouped_f6"</span>
<span class="op">)</span>

<span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"control"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>,
  <span class="st">"treated"</span>
<span class="op">)</span>

<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">file_name</span>, <span class="va">condition</span><span class="op">)</span>

<span class="co"># Combine your long data frame with the annotation</span>
<span class="va">pd_prot_long_annotated</span> <span class="op">&lt;-</span> <span class="va">pd_prot_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">annotation</span>, by <span class="op">=</span> <span class="st">"file_name"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="other-search-engines-and-software">Other search engines and software<a class="anchor" aria-label="anchor" href="#other-search-engines-and-software"></a>
</h2>
<p>As mentioned in the beginning of this vignette you can use the output of any search engine as long as it contains the minimally required columns. If it is not in the right format you can see if some of the above transformations can be applied to your data. It is also always useful to check if you can find additional columns that help you in your analysis and that you can export from your search engine. Always make sure that all of your observations are ones you are interested in. Check if there are decoys, contaminants or non-proteotypic peptides in your data. For protein-centric analysis, potentially remove quantifications that rely on only a few peptides.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
