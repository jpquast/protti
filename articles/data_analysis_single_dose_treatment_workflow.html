<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Single Dose Treatment Data Analysis Workflow • protti</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Single Dose Treatment Data Analysis Workflow">
<meta property="og:description" content="protti">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jpquast/protti/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="data_analysis_single_dose_treatment_workflow_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Single Dose Treatment Data Analysis Workflow</h1>
                        <h4 class="author">Dina Schuster</h4>
            
            <h4 class="date">2021-03-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/master/vignettes/data_analysis_single_dose_treatment_workflow.Rmd"><code>vignettes/data_analysis_single_dose_treatment_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>data_analysis_single_dose_treatment_workflow.Rmd</code></div>

    </div>

    
    
<style>
  body {
    text-align: justify}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette will give you an overview of how you can analyse single dose treatment LiP-MS or bottom-up proteomics data using <strong>protti</strong>. If you would like to analyse dose-response data with samples of multiple treatment concentrations you might want to look at the <a href="https://jpquast.github.io/protti/articles/data_analysis_dose_response_workflow.html">dose-response data analysis vignette</a>. Before analysing your data please make sure that it is of sufficient quality and that you do not have any outliers in your data. To do this you can take a look at the <a href="https://jpquast.github.io/protti/articles/quality_control_workflow.html">quality control vignette</a>.</p>
<div id="protti" class="section level2">
<h2 class="hasAnchor">
<a href="#protti" class="anchor"></a>protti</h2>
<p><strong>protti</strong> includes several functions that make it easy for the user to analyse and interpret data from LiP-MS or bottom-up proteomics experiments. The R package includes functions for</p>
<ul>
<li>Quality control (see <a href="https://jpquast.github.io/protti/articles/quality_control_workflow.html">quality control vignette</a> for more detailed information)</li>
<li>Data preparation
<ul>
<li>Median normalisation</li>
<li>Data filtering</li>
<li>Protein abundance calculation from precursor or peptide intensities</li>
<li>Imputation of missing values</li>
<li>Fetching of database information (ChEBI, GO, KEGG, MobiDB, UniProt)</li>
<li>Calculation of sequence coverage</li>
</ul>
</li>
<li>Data analysis
<ul>
<li>Statistical hypothesis tests</li>
<li>Fitting of dose-response curves (relevant for experiments with several treatment concentrations, click <a href="https://jpquast.github.io/protti/articles/data_analysis_dose_response_workflow.html">here</a> for more information)</li>
</ul>
</li>
<li>Data visualisation
<ul>
<li>Volcano plots</li>
<li>Barcode plots (plots that show protein coverage and significant changes projected onto the protein sequence)</li>
<li>Wood’s plots</li>
<li>Profile plots</li>
</ul>
</li>
<li>Data interpretation
<ul>
<li>Treatment enrichment (check if your hits are enriched with known targets)</li>
<li>GO-term enrichment</li>
<li>Network analysis (based on STRING database information)</li>
<li>KEGG pathway enrichment</li>
</ul>
</li>
</ul>
<p>You can read more about specific functions and how to use them by calling e.g. <code><a href="../reference/median_normalisation.html">?median_normalisation</a></code> (for the <code><a href="../reference/median_normalisation.html">median_normalisation()</a></code> function). Calling <code><a href="https://rdrr.io/r/utils/Question.html">?</a></code> followed by the function name will display the function documentation and give you more detailed information about the function. This can be done for any of the functions included in the package.</p>
<p>This document will give you an overview of data preparation, data analysis, data visualisation and data interpretation functions included in <strong>protti</strong>. It will show you how they can be applied to your data. The examples in this file are run on a <a href="https://www.nature.com/articles/s41467-020-18071-x">published</a> LiP-MS dataset. In the experiment a HeLa cell lysate was treated with different amounts of the drug Rapamycin and it could be shown that the target of Rapamycin (FKBP12) could be successfully identified. For this vignette we are using a filtered version of the original data set which includes only the 10 μM treatment concentration and the control (untreated). For simplicity only 50 proteins are included in the dataset.</p>
<p>The data set is produced from the output of <a href="https://biognosys.com/shop/spectronaut">Spectronaut™</a>. However, if you have any other data such as DDA data that was searched with a different search engine you can still apply <strong>protti</strong>’s functions. Just make sure that your data frame contains <a href="https://r4ds.had.co.nz/tidy-data.html">tidy data</a>. That means data should be contained in a long format (e.g. all sample names in one column) rather than a wide format (e.g. each sample name in its own column). You can easily achieve this by using the <code>pivot_longer()</code> function from the <code>tidyr</code> package. If you are unsure about how your input data is supposed to look like, please use the <code><a href="../reference/create_synthetic_data.html">create_synthetic_data()</a></code> function and compare this to your data. You can also take a look at the <a href="https://jpquast.github.io/protti/articles/input_preparation_workflow.html">input preparation vignette</a>, there you will find all the necessary information on how to get your data into the correct format.</p>
<p>The input data should have a similar structure to this example:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Sample</th>
<th align="center">Replicate</th>
<th align="center">Peptide</th>
<th align="center">Condition</th>
<th align="center">log2(intensity)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">sample1</td>
<td align="center">1</td>
<td align="center">PEPTIDER</td>
<td align="center">treated</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="center">sample1</td>
<td align="center">1</td>
<td align="center">PEPTI</td>
<td align="center">treated</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td align="center">sample1</td>
<td align="center">1</td>
<td align="center">PEPTIDE</td>
<td align="center">treated</td>
<td align="center">17</td>
</tr>
<tr class="even">
<td align="center">sample2</td>
<td align="center">1</td>
<td align="center">PEPTIDER</td>
<td align="center">untreated</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="center">sample2</td>
<td align="center">1</td>
<td align="center">PEPTI</td>
<td align="center">untreated</td>
<td align="center">18</td>
</tr>
<tr class="even">
<td align="center">sample2</td>
<td align="center">1</td>
<td align="center">PEPTIDE</td>
<td align="center">untreated</td>
<td align="center">12</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="how-to-use-protti-to-analyse-your-data" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-use-protti-to-analyse-your-data" class="anchor"></a>How to use protti to analyse your data</h1>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>Before we can start analysing our data, we need to load the <strong>protti</strong> package. This is done by using the base R function <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. In addition, we are also loading the packages <code>magrittr</code> and <code>dplyr</code>. Both <code>magrittr</code> and <code>dplyr</code> are part of the <a href="https://www.tidyverse.org">tidyverse</a>, a collection of packages that provide useful functionalities for data processing and visualisation. If you use many tidyverse packages in your workflow you can easily load all at once by calling <code><a href="https://rdrr.io/r/base/library.html">library(tidyverse)</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jpquast/protti">protti</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<p>After having loaded the required packages we will load our data set into the R environment. In order to do this for your data set you can use the function <code><a href="../reference/read_protti.html">read_protti()</a></code>. This function is a wrapper around the fast <code>fread()</code> function from the <a href="https://rdatatable.gitlab.io/data.table/"><code>data.table</code></a> package and the <code>clean_names()</code> function from the <a href="http://sfirke.github.io/janitor/"><code>janitor</code></a> package. This will allow you to not only load your data into R very fast, but also to clean up the column names into lower snake case to make them more R-friendly. This will make it easier to remember them and to use them in your data analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To read in your own data you can use read_protti()</span>
<span class="va">your_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_protti.html">read_protti</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"mydata/data.csv"</span><span class="op">)</span></code></pre></div>
<p>For this example we are going to use the <code>rapamycin_10uM</code> test data set included in <strong>protti</strong>. To read in the file we are simply going to use the <code>utils</code> function <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"rapamycin_10uM"</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h2>
<div id="log2-transformation-median-normalisation-and-cv-filtering" class="section level3">
<h3 class="hasAnchor">
<a href="#log2-transformation-median-normalisation-and-cv-filtering" class="anchor"></a>Log2 transformation, median normalisation and CV filtering</h3>
<p>After inspecting the data and performing quality control (see <a href="https://jpquast.github.io/protti/articles/quality_control_workflow.html">quality control vignette</a> for more information) we will now start to prepare the data for the analysis.</p>
<p>First, we remove decoy hits (used for false discovery rate estimation). Our example data set contains a column called <code>eg_is_decoy</code> that consists of logicals indicating whether or not the peptide is a decoy hit. To remove decoys we will use the <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>.</p>
<p>Next, we log2 transform our intensities, then we are median normalising the data. To transform the intensities we are using the <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> which creates a new column while maintaining the original column.</p>
<p>Note that we are also using the pipe operator <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> included in the R package <a href="https://magrittr.tidyverse.org/index.html"><code>magrittr</code></a>. <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> takes the output of the preceding function and supplies it as the first argument of the following function. Using <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> makes code easier to read and follow.</p>
<p>For median normalisation we are using the <strong>protti</strong> function <code><a href="../reference/median_normalisation.html">median_normalisation()</a></code>. The function normalises intensities for each run to the median of all runs. This is only necessary if your search algorithm does not already median normalise your intensities. For the example data we have disabled median normalisation in Spectronaut, therefore we need to median normalise now. The formula for median normalisation is:</p>
<div class="blackbox">
<p>
<span class="math display"><span class="math display">\[median ~ normalised ~ intensity  = intensity - median ( run ~ intensity ) + median ( global ~ intensity) \]</span></span>
</p>
</div>
<p>To ensure that only good peptide measurements will be used for further analysis, we will also filter our data based on coefficients of variation (CV). In order to do this we are using the function <code><a href="../reference/filter_cv.html">filter_cv()</a></code>. For this example we are retaining peptides with a CV &lt; 25 % in at least one of the two conditions.</p>
<p>The CVs are calculated within the function according to the formula:</p>
<div class="blackbox">
<p>
<span class="math display"><span class="math display">\[CV = \frac{standard ~ deviation}{mean} * 100\]</span></span>
</p>
</div>
<p><em>Note: The use of the <code><a href="../reference/filter_cv.html">filter_cv()</a></code> function is optional. You should be careful with using it since it might remove a lot of your data if your experiment was rather noisy. However, especially in these cases it might be useful to apply the function in order to remove peptides with a poor quality beforehand to improve the overall result.</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_normalised</span> <span class="op">&lt;-</span> <span class="va">rapamycin_10uM</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">eg_is_decoy</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>intensity_log2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">fg_quantity</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/median_normalisation.html">median_normalisation</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">r_file_name</span>, 
                       intensity_log2 <span class="op">=</span> <span class="va">intensity_log2</span><span class="op">)</span>

<span class="va">data_filtered</span> <span class="op">&lt;-</span> <span class="va">data_normalised</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/filter_cv.html">filter_cv</a></span><span class="op">(</span>grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>, 
            condition <span class="op">=</span> <span class="va">r_condition</span>, 
            log2_intensity <span class="op">=</span> <span class="va">intensity_log2</span>, 
            cv_limit <span class="op">=</span> <span class="fl">0.25</span>,
            min_conditions <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="remove-non-proteotypic-peptides" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-non-proteotypic-peptides" class="anchor"></a>Remove non-proteotypic peptides</h3>
<p>For LiP-MS analysis we commonly remove non-proteotypic peptides (i.e. peptides that could come from more than one protein). If you detect a change in non-proteotypic peptides it is not possible to clearly assign which protein it comes from and therefore which protein is affected by your treatment. If you are using the output from Spectronaut you will find a column called “pep_is_proteotypic”. This column contains logicals indicating whether your peptide is proteotypic or not.</p>
<p>To filter out non proteotypic peptides we are using the <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_filtered_proteotypic</span> <span class="op">&lt;-</span> <span class="va">data_filtered</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pep_is_proteotypic</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="fetching-database-information-and-assigning-peptide-types" class="section level3">
<h3 class="hasAnchor">
<a href="#fetching-database-information-and-assigning-peptide-types" class="anchor"></a>Fetching database information and assigning peptide types</h3>
<p>In order to obtain more information about our identified proteins we are going to use the function <code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code> to download some of the available information from UniProt directly.</p>
<p><code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code> uses a vector of UniProt IDs as its input. We are producing this vector by using the base R function <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code> which will extract all unique elements in the selected protein ID column. In this case we want to download the full protein name, gene IDs, GO terms associated with molecular function, StringDB IDs, information on known interacting proteins, location of the active site, location of binding sites, PDB entries, protein length and protein sequence. There are more options for columns to add (for more information on possible columns to add click <a href="https://www.uniprot.org/help/uniprotkb_column_names">here</a>).</p>
<p><code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code> returns a new data frame. In order to be able to merge this with our original data frame we have to rename the ID column to match the name of the protein ID column of our original data frame. To do this we are using <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> function.</p>
<p>To merge the two data frames we are using the <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code>. We are matching the two data frames by the column “pg_protein_accessions”. By using <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code> we are retaining all rows from our original data frame while adding the columns from the data fame generated with <code><a href="../reference/fetch_uniprot.html">fetch_uniprot()</a></code>.</p>
<p><em>Note: you can also directly join the UniProt data frame with your data without the need to rename its <code>id</code> column. You can specify in the <code>by</code> argument in <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code> that two columns are differently named.</em></p>
<p>Next, we would like to assign the trypticity of our peptides (i.e. if the peptides are fully-tryptic, semi-tryptic or non-tryptic). In order to do this we will first need to define the peptide positions in the protein and find the preceding and following amino acids. To obtain this information we are using the <strong>protti</strong> function <code><a href="../reference/find_peptide.html">find_peptide()</a></code>. The output of this function can then be used in the function <code><a href="../reference/peptide_type.html">peptide_type()</a></code> which will add an additional column with the peptide trypticity information. By using the function <code><a href="../reference/sequence_coverage.html">sequence_coverage()</a></code> we are adding an additional column to the data frame containing information on how much of the protein sequence we identified in our experiment.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uniprot_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_filtered_proteotypic</span><span class="op">$</span><span class="va">pg_protein_accessions</span><span class="op">)</span>

<span class="va">uniprot</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/fetch_uniprot.html">fetch_uniprot</a></span><span class="op">(</span>
    uniprot_ids <span class="op">=</span> <span class="va">uniprot_ids</span>,
    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"protein names"</span>,
      <span class="st">"genes"</span>,
      <span class="st">"go(molecular function)"</span>,
      <span class="st">"database(String)"</span>,
      <span class="st">"interactor"</span>,
      <span class="st">"feature(ACTIVE SITE)"</span>,
      <span class="st">"feature(BINDING SITE)"</span>,
      <span class="st">"database(PDB)"</span>,
      <span class="st">"length"</span>,
      <span class="st">"sequence"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>pg_protein_accessions <span class="op">=</span> <span class="va">id</span><span class="op">)</span>

<span class="va">data_filtered_uniprot</span> <span class="op">&lt;-</span> <span class="va">data_filtered_proteotypic</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">uniprot</span>,
            by <span class="op">=</span> <span class="st">"pg_protein_accessions"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/find_peptide.html">find_peptide</a></span><span class="op">(</span>protein_sequence <span class="op">=</span> <span class="va">sequence</span>,
               peptide_sequence <span class="op">=</span> <span class="va">pep_stripped_sequence</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/peptide_type.html">peptide_type</a></span><span class="op">(</span>aa_before <span class="op">=</span> <span class="va">aa_before</span>,
               last_aa <span class="op">=</span> <span class="va">last_aa</span>, 
               aa_after <span class="op">=</span> <span class="va">aa_after</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/sequence_coverage.html">sequence_coverage</a></span><span class="op">(</span>protein_sequence <span class="op">=</span> <span class="va">sequence</span>,
                    peptides <span class="op">=</span> <span class="va">pep_stripped_sequence</span><span class="op">)</span></code></pre></div>
<p>With the <code><a href="../reference/qc_sequence_coverage.html">qc_sequence_coverage()</a></code> function, you can use the sequence coverage information to check how coverage is distributed over all proteins in the sample. Usually, the center of the distribution is low due to many proteins with poor coverage. For this subseted data set with only 40 proteins the sequence coverage is distributed relatively evenly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qc_sequence_coverage.html">qc_sequence_coverage</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">data_filtered_uniprot</span>,
  protein_identifier <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  coverage <span class="op">=</span> <span class="va">coverage</span>
<span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/coverage_plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#data-analysis" class="anchor"></a>Data analysis</h2>
<div id="statistical-hypothesis-test" class="section level3">
<h3 class="hasAnchor">
<a href="#statistical-hypothesis-test" class="anchor"></a>Statistical hypothesis test</h3>
<p>To test if there is a difference between the peptide abundances in our two conditions (i.e. Rapamycin treated and untreated) we are going to use a Welch’s t-test (unpaired). Welch’s t-test is a method for comparing means of two independent sample groups and it does not assume equal variances between groups (as Student’s t-test would).</p>
<p>Before the statistical hypothesis test we have to define the types of missing values present in our data set. We are going to use the function <code><a href="../reference/assign_missingness.html">assign_missingness()</a></code> which will return a column with information on the types of missingness we have in our data (i.e. complete, missing at random (MAR) or missing not at random (MNAR)). We are using the default parameters of this function which assumes that missing values are MAR when the conditions are at least 70 % complete (adjusted downward). Missing values are assumed to be MNAR when less than 25 % of values are present (adjusted_downward) in one condition if the other condition is complete.</p>
<p>After assigning the types of data missingness we are using the function <code><a href="../reference/diff_abundance.html">diff_abundance()</a></code>. In this case by selecting <code>method = t-test</code> the function will perform a Welch’s t-test. There are also options included to perform a moderated t-test based on the R package <code>limma</code> or to detect differential abundances based on the algorithm implemented in the R package <code>proDA</code>. The algorithm used for <code>proDA</code> is based on a probabilistic dropout model which facilitates hypothesis testing without imputation.</p>
<p>Please note that in this example we are not imputing missing values. You can, however, do so by using the function <code><a href="../reference/impute.html">impute()</a></code>. This function uses the output of <code><a href="../reference/assign_missingness.html">assign_missingness()</a></code> as its input. You can use two different imputation methods:</p>
<ul>
<li>
<code>method = ludovic</code> will sample values that are MNAR from a normal distribution around a value that is 3 (log2) lower than the mean intensity of the non-missing condition. The method is named after and created by our colleague <a href="https://imsb.ethz.ch/research/picotti/PeoplePicotti/ludovicgillet.html">Ludovic Gillet</a>.</li>
<li>
<code>method = noise</code> will sample MNAR values from a normal distribution around the mean noise of the complete condition. This requires you to have an additional column with information on the noise that can be obtained from Spectronaut.</li>
</ul>
<p>Both methods impute MAR data using the mean and variance of the condition with the missing data.</p>
<p>Since we are dealing with a LiP-MS data set we are performing the statistical analysis on the precursor level. For protein abundance data you can simply use protein abundances as your intensities and select your protein groups column for the grouping argument. Make sure to retain any columns you need for further data analysis with the <code>retain_columns</code> argument of both functions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diff_abundance_data</span> <span class="op">&lt;-</span> <span class="va">data_filtered_uniprot</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/assign_missingness.html">assign_missingness</a></span><span class="op">(</span>
    sample <span class="op">=</span> <span class="va">r_file_name</span>,
    condition <span class="op">=</span> <span class="va">r_condition</span>,
    grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,
    intensity <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,
    ref_condition <span class="op">=</span> <span class="st">"control"</span>,
    completeness_MAR <span class="op">=</span> <span class="fl">0.7</span>,
    completeness_MNAR <span class="op">=</span> <span class="fl">0.25</span>,
    retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span>, <span class="va">go_molecular_function</span>, <span class="va">database_string</span>, <span class="va">start</span>, <span class="va">end</span>, <span class="va">length</span>, <span class="va">coverage</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/diff_abundance.html">diff_abundance</a></span><span class="op">(</span>
    sample <span class="op">=</span> <span class="va">r_file_name</span>,
    condition <span class="op">=</span> <span class="va">r_condition</span>,
    grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,
    intensity_log2 <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,
    missingness <span class="op">=</span> <span class="va">missingness</span>,
    comparison <span class="op">=</span> <span class="va">comparison</span>,
    ref_condition <span class="op">=</span> <span class="st">"control"</span>,
    method <span class="op">=</span> <span class="st">"t-test"</span>,
    retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span>, <span class="va">go_molecular_function</span>, <span class="va">database_string</span>, <span class="va">start</span>, <span class="va">end</span>, <span class="va">length</span>, <span class="va">coverage</span><span class="op">)</span>
  <span class="op">)</span> </code></pre></div>
</div>
<div id="p-value-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#p-value-distribution" class="anchor"></a>p-value distribution</h3>
<p>The p-value calculated with the t-test is automatically adjusted for multiple testing using the Benjamini-Hochberg (FDR) correction. This assures that we keep the false discovery rate low. An assumption of this correction is however, that p-values should have an overall even distribution with a concentration of values in the significant range. You can check this by using the protti function <code><a href="../reference/plot_pval_distribution.html">plot_pval_distribution()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_pval_distribution.html">plot_pval_distribution</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diff_abundance_data</span>,
                       grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,
                       pval <span class="op">=</span> <span class="va">pval</span>
                       <span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/pval_distribution-1.png" width="576" style="display: block; margin: auto;"></p>
<p>For this subset of data the distribution of p-values is relatively equal and there is no increase in values in the low p-value range but rather a decrease. This means that the Benjamini-Hochberg algorithm might not be suitable for correcting these p-values. You can pick another algorithm for the correction and supply it to the <code>p_adj_method</code> argument and run <code><a href="../reference/diff_abundance.html">diff_abundance()</a></code> again. The available methods are any methods that can be supplied to the standard R function <code><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust()</a></code> that is used internally. You can also just use this function or any other correction algorithm on your data and overwrite the values in the <code>adj_pval</code> column.</p>
<p><em>Note: If the p-values are not fulfilling the assumption of the multiple-testing correction, meaning very little observations are changing significantly, it can happen that only a few significant hits remain after adjusting the p-value. This can be a common occurrence so you should always have a look at the p-value distribution. This will help you decide on whether or not you should use adjusted p-values, not adjusted p-values or if you should adjust them with a specific method.</em></p>
</div>
<div id="volcano-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#volcano-plot" class="anchor"></a>Volcano plot</h3>
<p>Next we are going to visualise the output of the previously performed hypothesis test to assess the results of our experiment. For this we are going to plot a volcano plot with fold-changes on the x-axis and the adjusted p-value (q-value) or p-value on the y-axis. The output of the previously used <code><a href="../reference/diff_abundance.html">diff_abundance()</a></code> function is ideal to use for the <code><a href="../reference/volcano_protti.html">volcano_protti()</a></code> function as it contains all the information we need: precursor IDs, protein IDs, fold changes (<code>diff</code>) and adjusted p-values (<code>adj_pval</code>). We are going to highlight the peptides of the known target of Rapamycin FKBP12 (UniProt ID = P62942) in blue to quickly find the peptides in the plot. You can also make the plot interactive by setting <code>interactive = TRUE</code>. This will help you quickly obtain more information on each point in the plot. We are going to plot the volcano plot with and without adjusted p-values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/volcano_protti.html">volcano_protti</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">diff_abundance_data</span>,
  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,
  log2FC <span class="op">=</span> <span class="va">diff</span>,
  significance <span class="op">=</span> <span class="va">pval</span>,
  method <span class="op">=</span> <span class="st">"target"</span>,
  target_column <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  target <span class="op">=</span> <span class="st">"P62942"</span>,
  x_axis_label <span class="op">=</span> <span class="st">"log2(fold change) Rapamycin treated vs. untreated"</span>,
  y_axis_label <span class="op">=</span> <span class="st">"-log10(p-value)"</span>,
  title <span class="op">=</span> <span class="st">"Volcano plot (p-value not adjusted)"</span>,
  significance_cutoff <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/volcano_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/volcano_protti.html">volcano_protti</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">diff_abundance_data</span>,
  grouping <span class="op">=</span> <span class="va">eg_precursor_id</span>,
  log2FC <span class="op">=</span> <span class="va">diff</span>,
  significance <span class="op">=</span> <span class="va">adj_pval</span>,
  method <span class="op">=</span> <span class="st">"target"</span>,
  target_column <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  target <span class="op">=</span> <span class="st">"P62942"</span>,
  x_axis_label <span class="op">=</span> <span class="st">"log2(fold change) Rapamycin treated vs. untreated"</span>,
  y_axis_label <span class="op">=</span> <span class="st">"-log10(q-value)"</span>,
  title <span class="op">=</span> <span class="st">"Volcano plot"</span>,
  significance_cutoff <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/volcano_plot-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="barcode-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#barcode-plot" class="anchor"></a>Barcode plot</h3>
<p>For LiP-MS experiments a good way to see where on the protein the changes due to binding or conformational changes occur is to plot a barcode plot. A barcode plot can be created with the <strong>protti</strong> function <code><a href="../reference/barcode_plot.html">barcode_plot()</a></code>. The detected peptides are coloured in grey and the changing peptides are highlighted in blue.</p>
<p>In order to produce a barcode plot only for our target FKBP12 we are creating a data frame that contains only information for our target protein. We are doing this by using <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> function. The filtered data frame is then used as the input for the plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">FKBP12</span> <span class="op">&lt;-</span> <span class="va">diff_abundance_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span> <span class="op">==</span> <span class="st">"P62942"</span><span class="op">)</span>

<span class="fu"><a href="../reference/barcode_plot.html">barcode_plot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">FKBP12</span>,
  start_position <span class="op">=</span> <span class="va">start</span>,
  end_position <span class="op">=</span> <span class="va">end</span>,
  protein_length <span class="op">=</span> <span class="va">length</span>,
  coverage <span class="op">=</span> <span class="va">coverage</span>,
  colouring <span class="op">=</span> <span class="va">diff</span>,
  cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fl">1</span>, adj_pval <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,
  protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>
  <span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/barcode_plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="woods-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#woods-plot" class="anchor"></a>Wood’s plot</h3>
<p>An additional way to plot LiP-MS changes are Wood’s plots. These plots will show the extent of the change along the protein sequence. To produce a Wood’s plot we are using the function <code><a href="../reference/woods_plot.html">woods_plot()</a></code> and colour the peptides according to their adjusted p-values.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/woods_plot.html">woods_plot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">FKBP12</span>,
  fold_change <span class="op">=</span> <span class="va">diff</span>,
  start_position <span class="op">=</span> <span class="va">start</span>,
  end_position <span class="op">=</span> <span class="va">end</span>,
  protein_length <span class="op">=</span> <span class="va">length</span>,
  coverage <span class="op">=</span> <span class="va">coverage</span>,
  colouring <span class="op">=</span> <span class="va">adj_pval</span>,
  protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  fold_change_cutoff <span class="op">=</span> <span class="fl">1</span>,
  <span class="op">)</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/woods_plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="peptide-profile-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#peptide-profile-plots" class="anchor"></a>Peptide profile plots</h3>
<p>To see how the individual precursors in our target protein are changing with the treatment we are plotting profile plots by using the function <code><a href="../reference/plot_peptide_profiles.html">plot_peptide_profiles()</a></code>. This is particularly useful as you can quickly see if your whole protein changes in abundance or only a fraction of precursors/peptides. If you have protein abundance data you can also use the plot to show changes in protein abundance over your treatment condition(s). By selecting multiple targets (as a vector) you can produce the plot for multiple proteins.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">FKBP12_intensity</span> <span class="op">&lt;-</span> <span class="va">data_filtered_uniprot</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pg_protein_accessions</span> <span class="op">==</span> <span class="st">"P62942"</span><span class="op">)</span>

<span class="fu"><a href="../reference/plot_peptide_profiles.html">plot_peptide_profiles</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">FKBP12_intensity</span>,
  sample <span class="op">=</span> <span class="va">r_file_name</span>,
  peptide <span class="op">=</span> <span class="va">eg_precursor_id</span>,
  intensity_log2 <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,
  grouping <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  targets <span class="op">=</span> <span class="st">"P62942"</span>,
  protein_abundance_plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt; $P62942</span></code></pre></div>
<p><img src="data_analysis_single_dose_treatment_workflow_files/figure-html/protile_plot-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="additional-helpful-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-helpful-functions" class="anchor"></a>Additional helpful functions</h2>
<p><strong>protti</strong> includes additional helpful functions that do not make sense to use for this data set but are great to use for data sets of full size that have global changes. These functions include the <code><a href="../reference/go_enrichment.html">go_enrichment()</a></code>function that helps you check if your hits are enriched for specific gene ontology (GO) terms, the <code><a href="../reference/network_analysis.html">network_analysis()</a></code> function that plots a String network based on information from StringDB for your hits and the <code><a href="../reference/kegg_enrichment.html">kegg_enrichment()</a></code> function which checks for enriched pathways in your hits. Furthermore, you can directly check for enrichment of a self defined treatment with the <code><a href="../reference/treatment_enrichment.html">treatment_enrichment()</a></code> function.</p>
<p>Here we will quickly show you how you could use these functions in a full size data set with more global changes:</p>
<p>For GO enrichment you would add an additional column to your data frame containing information on whether your hit is significant or not. You can do this by using the <code>dplyr</code> function <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> which will add an additional column to your data frame. Here we want the column to contain logicals that are either TRUE when the adjusted p-value is below 0.05 and the log2(fold change) is below -1 or above 1 or to be FALSE if this is not the case. We are using the <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> function to produce the logicals. Furthermore, we annotate if the hit is true positive by marking peptides of the known Rapamycin binding protein FKBP12.</p>
<p>For the network analysis we are filtering the previously produced data frame containing the <code>is_significant</code> column for significant hits. This data frame can then be used as an input for <code><a href="../reference/network_analysis.html">network_analysis()</a></code> to check if the proteins can be found in an interaction network based on StringDB information.</p>
<p>For <code><a href="../reference/kegg_enrichment.html">kegg_enrichment()</a></code> you need to first use the function <code><a href="../reference/fetch_kegg.html">fetch_kegg()</a></code> to obtain the KEGG pathway identifiers for your data set. You can then use <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code>to join the output with the previously produced data frame containing a column indicating whether your hits are significant or not.</p>
<p>If you know all known interactors of your specific treatment you can check for an enrichment of these with the <code><a href="../reference/treatment_enrichment.html">treatment_enrichment()</a></code> function. This is particularly useful if your treatment has an effect on many proteins.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diff_abundance_significant</span> <span class="op">&lt;-</span> <span class="va">diff_abundance_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_significant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">adj_pval</span> <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># mark significant peptides</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>binds_treatment <span class="op">=</span> <span class="va">pg_protein_accessions</span> <span class="op">==</span> <span class="st">"P62942"</span><span class="op">)</span> <span class="co"># mark true positive hits</span>

<span class="co">### GO enrichment using "molecular function" annotation from UniProt</span>

<span class="fu"><a href="../reference/go_enrichment.html">go_enrichment</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">diff_abundance_significant</span>,
  protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
  is_significant <span class="op">=</span> <span class="va">is_significant</span>,
  go_annotations_uniprot <span class="op">=</span> <span class="va">go_molecular_function</span>
<span class="op">)</span>

<span class="co">### Network analysis</span>

<span class="va">network_input</span> <span class="op">&lt;-</span> <span class="va">diff_abundance_significant</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">is_significant</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/network_analysis.html">network_analysis</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">network_input</span>,
                 protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
                 string_id <span class="op">=</span> <span class="va">database_string</span>,
                 binds_treatment <span class="op">=</span> <span class="va">binds_treatment</span>,
                 organism_id <span class="op">=</span> <span class="fl">9606</span><span class="op">)</span>

<span class="co">### KEGG pathway enrichment</span>

<span class="co"># First you need to load KEGG pathway annotations from the KEGG database for your specific organism of interest.</span>
<span class="co"># In this case HeLa cells were used, therefore the organism of interest is homo sapiens (hsa)</span>

<span class="va">kegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_kegg.html">fetch_kegg</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"hsa"</span><span class="op">)</span>

<span class="co"># Next we need to annotate our data with KEGG pathway IDs and perform enrichment analysis</span>

<span class="va">diff_abundance_significant</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">kegg</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pg_protein_accessions"</span> <span class="op">=</span> <span class="st">"uniprot_id"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># columns containing proteins IDs are named differently</span>
  <span class="fu"><a href="../reference/kegg_enrichment.html">kegg_enrichment</a></span><span class="op">(</span>protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
                  is_significant <span class="op">=</span> <span class="va">is_significant</span>,
                  pathway_id <span class="op">=</span> <span class="va">pathway_id</span>,
                  pathway_name <span class="op">=</span> <span class="va">pathway_name</span><span class="op">)</span>

<span class="co">### Treatment enrichment analysis</span>

<span class="fu"><a href="../reference/treatment_enrichment.html">treatment_enrichment</a></span><span class="op">(</span><span class="va">diff_abundance_significant</span>,
                     protein_id <span class="op">=</span> <span class="va">pg_protein_accessions</span>,
                     is_significant <span class="op">=</span> <span class="va">is_significant</span>,
                     binds_treatment <span class="op">=</span> <span class="va">binds_treatment</span>,
                     treatment_name <span class="op">=</span> <span class="st">"Rapamycin"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jan-Philipp Quast, Dina Schuster.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
