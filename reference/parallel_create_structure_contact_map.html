<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Creates a contact map of all atoms from a structure file (using parallel processing) — parallel_create_structure_contact_map • protti</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a contact map of all atoms from a structure file (using parallel processing) — parallel_create_structure_contact_map"><meta property="og:description" content='This function is a wrapper around create_structure_contact_map() that allows the use of all
system cores for the creation of contact maps. Alternatively, it can be used for sequential
processing of large datasets. The benefit of this function over create_structure_contact_map()
is that it processes contact maps in batches, which is recommended for large datasets. If used
for parallel processing it should only be used on systems that have enough memory available.
Workers can either be set up manually before running the function with
future::plan(multisession) or automatically by the function (maximum number of workers
is 12 in this case). If workers are set up manually the processing_type argument should
be set to "parallel manual". In this case workers can be terminated after completion with
future::plan(sequential).'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/protein_structure_workflow.html">Protein Structure Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates a contact map of all atoms from a structure file (using parallel processing)</h1>
    <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/master/R/parallel_create_structure_contact_map.R" class="external-link"><code>R/parallel_create_structure_contact_map.R</code></a></small>
    <div class="hidden name"><code>parallel_create_structure_contact_map.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper around <code><a href="create_structure_contact_map.html">create_structure_contact_map()</a></code> that allows the use of all
system cores for the creation of contact maps. Alternatively, it can be used for sequential
processing of large datasets. The benefit of this function over <code><a href="create_structure_contact_map.html">create_structure_contact_map()</a></code>
is that it processes contact maps in batches, which is recommended for large datasets. If used
for parallel processing it should only be used on systems that have enough memory available.
Workers can either be set up manually before running the function with
<code>future::plan(multisession)</code> or automatically by the function (maximum number of workers
is 12 in this case). If workers are set up manually the <code>processing_type</code> argument should
be set to "parallel manual". In this case workers can be terminated after completion with
<code>future::plan(sequential)</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">parallel_create_structure_contact_map</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  data2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  auth_seq_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance_cutoff <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  pdb_model_number_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  return_min_residue_distance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  export_location <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_n <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  processing_type <span class="op">=</span> <span class="st">"parallel"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing at least a column with PDB ID information of which the name
can be provided to the <code>id</code> argument. If only this column is provided, all atom or residue
distances are calculated. Additionally, a chain column can be present in the data frame of which
the name can be provided to the <code>chain</code> argument. If chains are provided, only distances
of this chain relative to the rest of the structure are calculated. Multiple chains can be
provided in multiple rows. If chains are provided for one structure but not for another, the
rows should contain NAs. Furthermore, specific residue positions can be provided in the <code>auth_seq_id</code>
column if the selection should be further reduced. It is not recommended to create full
contact maps for more than a few structures due to time and memory limitations. If contact maps are
created only for small regions it is possible to create multiple maps at once. By default distances
of regions provided in this data frame to the complete structure are computed. If distances of regions
from this data frame to another specific subset of regions should be computed, the second subset
of regions can be provided through the optional <code>data2</code> argument.</p></dd>


<dt id="arg-data-">data2<a class="anchor" aria-label="anchor" href="#arg-data-"></a></dt>
<dd><p>optional, a data frame that contains a subset of regions for which distances to regions
provided in the <code>data</code> data frame should be computed. If regions from the <code>data</code> data
frame should be compared to the whole structure, data2 does not need to be provided.
This data frame should have the same structure and column names as the <code>data</code> data frame.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>a character column in the <code>data</code> data frame that contains PDB or UniProt IDs for
structures or AlphaFold predictions of which contact maps should be created. If a structure not
downloaded directly from PDB is provided (i.e. a locally stored structure file) to the
<code>structure_file</code> argument, this column should contain "my_structure" as content.</p></dd>


<dt id="arg-chain">chain<a class="anchor" aria-label="anchor" href="#arg-chain"></a></dt>
<dd><p>optional, a character column in the <code>data</code> data frame that contains chain
identifiers for the structure file. Identifiers defined by the structure author should be used.
Distances will be only calculated between the provided chains and the rest of the structure.</p></dd>


<dt id="arg-auth-seq-id">auth_seq_id<a class="anchor" aria-label="anchor" href="#arg-auth-seq-id"></a></dt>
<dd><p>optional, a character (or numeric) column in the <code>data</code> data frame
that contains semicolon separated positions of regions for which distances should be calculated.
This always needs to be provided in combination with a corresponding chain in <code>chain</code>.
The position should match the positioning defined by the structure author. For
PDB structures this information can be obtained from the <code>find_peptide_in_structure</code>
function. The corresponding column in the output is called <code>auth_seq_id</code>. If an
AlphaFold prediction is provided, UniProt positions should be used. If single positions
and not stretches of amino acids are provided, the column can be numeric and does not need
to contain the semicolon separator.</p></dd>


<dt id="arg-distance-cutoff">distance_cutoff<a class="anchor" aria-label="anchor" href="#arg-distance-cutoff"></a></dt>
<dd><p>a numeric value specifying the distance cutoff in Angstrom. All values
for pairwise comparisons are calculated but only values smaller than this cutoff will be
returned in the output. If a cutoff of e.g. 5 is selected then only residues with a distance of
5 Angstrom and less are returned. Using a small value can reduce the size of the contact map
drastically and is therefore recommended. The default value is 10.</p></dd>


<dt id="arg-pdb-model-number-selection">pdb_model_number_selection<a class="anchor" aria-label="anchor" href="#arg-pdb-model-number-selection"></a></dt>
<dd><p>a numeric vector specifying which models from the structure
files should be considered for contact maps. E.g. NMR models often have many models in one file.
The default for this argument is c(0, 1). This means the first model of each structure file is
selected for contact map calculations. For AlphaFold predictions the model number is 0
(only .pdb files), therefore this case is also included here.</p></dd>


<dt id="arg-return-min-residue-distance">return_min_residue_distance<a class="anchor" aria-label="anchor" href="#arg-return-min-residue-distance"></a></dt>
<dd><p>a logical value that specifies if the contact map should be
returned for all atom distances or the minimum residue distances. Minimum residue distances are
smaller in size. If atom distances are not strictly needed it is recommended to set this
argument to TRUE. The default is TRUE.</p></dd>


<dt id="arg-export">export<a class="anchor" aria-label="anchor" href="#arg-export"></a></dt>
<dd><p>a logical value that indicates if contact maps should be exported as ".csv". The
name of the file will be the structure ID. Default is <code>export = FALSE</code>.</p></dd>


<dt id="arg-export-location">export_location<a class="anchor" aria-label="anchor" href="#arg-export-location"></a></dt>
<dd><p>optional, a character value that specifies the path to the location in
which the contact map should be saved if <code>export = TRUE</code>. If left empty, they will be
saved in the current working directory. The location should be provided in the following format
"folderA/folderB".</p></dd>


<dt id="arg-split-n">split_n<a class="anchor" aria-label="anchor" href="#arg-split-n"></a></dt>
<dd><p>a numeric value that specifies the number of structures that should be included
in each batch. Default is 40.</p></dd>


<dt id="arg-processing-type">processing_type<a class="anchor" aria-label="anchor" href="#arg-processing-type"></a></dt>
<dd><p>a character value that is either "parallel" for parallel processing or
"sequential" for sequential processing. Alternatively it can also be "parallel manual" in this
case you have to set up the number of cores on your own using the <code>future::plan(multisession)</code>
function. The default is "parallel".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of contact maps for each PDB or UniProt ID provided in the input is returned.
If the <code>export</code> argument is TRUE, each contact map will be saved as a ".csv" file in the
current working directory or the location provided to the <code>export_location</code> argument.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create example data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  pdb_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"6NPF"</span>, <span class="st">"1C14"</span>, <span class="st">"3NIR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  auth_seq_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1;2;3;4;5;6;7"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create contact map</span></span></span>
<span class="r-in"><span><span class="va">contact_maps</span> <span class="op">&lt;-</span> <span class="fu">parallel_create_structure_contact_map</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="va">pdb_id</span>,</span></span>
<span class="r-in"><span>  chain <span class="op">=</span> <span class="va">chain</span>,</span></span>
<span class="r-in"><span>  auth_seq_id <span class="op">=</span> <span class="va">auth_seq_id</span>,</span></span>
<span class="r-in"><span>  split_n <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">contact_maps</span><span class="op">[[</span><span class="st">"3NIR"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contact_maps</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

