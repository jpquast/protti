<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Maps peptides onto a PDB structure or AlphaFold prediction — map_peptides_on_structure • protti</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Maps peptides onto a PDB structure or AlphaFold prediction — map_peptides_on_structure"><meta property="og:description" content="Peptides are mapped onto PDB structures or AlphaFold prediction based on their positions.
This is accomplished by replacing the B-factor information in the structure file with
values that allow highlighting of peptides, protein regions or amino acids when the structure
is coloured by B-factor. In addition to simply highlighting peptides, protein regions or amino
acids, a continuous variable such as fold changes associated with them can be mapped onto the
structure as a colour gradient."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/protein_structure_workflow.html">Protein Structure Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Maps peptides onto a PDB structure or AlphaFold prediction</h1>
    <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/HEAD/R/map_peptides_on_structure.R" class="external-link"><code>R/map_peptides_on_structure.R</code></a></small>
    <div class="hidden name"><code>map_peptides_on_structure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Peptides are mapped onto PDB structures or AlphaFold prediction based on their positions.
This is accomplished by replacing the B-factor information in the structure file with
values that allow highlighting of peptides, protein regions or amino acids when the structure
is coloured by B-factor. In addition to simply highlighting peptides, protein regions or amino
acids, a continuous variable such as fold changes associated with them can be mapped onto the
structure as a colour gradient.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">map_peptides_on_structure</span><span class="op">(</span></span>
<span>  <span class="va">peptide_data</span>,</span>
<span>  <span class="va">uniprot_id</span>,</span>
<span>  <span class="va">pdb_id</span>,</span>
<span>  <span class="va">chain</span>,</span>
<span>  <span class="va">auth_seq_id</span>,</span>
<span>  <span class="va">map_value</span>,</span>
<span>  file_format <span class="op">=</span> <span class="st">".cif"</span>,</span>
<span>  scale_per_structure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  export_location <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  structure_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>peptide_data</dt>
<dd><p>a data frame that contains the input columns to this function. If structure
or prediction files should be fetched automatically, please provide column names to the following
arguments: <strong>uniprot_id</strong>, <strong>pdb_id</strong>, <strong>chain</strong>, <strong>auth_seq_id</strong>,
<strong>map_value</strong>. If no PDB structure for a protein is available the <code>pdb_id</code> and <code>chain</code>
column should contain NA at these positions. If a structure or prediction file is provided in the
<code>structure_file</code> argument, this data frame should only contain information associated with
the provided structure. In case of a user provided structure, column names should be provided to
the following arguments: <strong>uniprot_id</strong>, <strong>chain</strong>, <strong>auth_seq_id</strong>, <strong>map_value</strong>.</p></dd>


<dt>uniprot_id</dt>
<dd><p>a character column in the <code>peptide_data</code> data frame that contains UniProt
identifiers for a corresponding peptide, protein region or amino acid.</p></dd>


<dt>pdb_id</dt>
<dd><p>a character column in the <code>peptide_data</code> data frame that contains PDB
identifiers for structures in which a corresponding peptide, protein region or amino acid is found.
If a protein prediction should be fetched from AlphaFold, this column should contain NA. This
column is not required if a structure or prediction file is provided in the <code>structure_file</code>
argument.</p></dd>


<dt>chain</dt>
<dd><p>a character column in the <code>peptide_data</code> data frame that contains the name of
the chain from the PDB structure in which the peptide, protein region or amino acid is found.
If a protein prediction should be fetched from AlphaFold, this column should contain NA. If an
AlphaFold prediction is provided to the <code>structure_file</code> argument the chain should be
provided as usual (All AlphaFold predictions only have chain A). <strong>Important:</strong> please provide
the author defined chain definitions for both ".cif" and ".pdb" files. When the output of the
<code>find_peptide_in_structure</code> function is used as the input for this function, this
corresponds to the <code>auth_asym_id</code> column.</p></dd>


<dt>auth_seq_id</dt>
<dd><p>optional, a character (or numeric) column in the <code>peptide_data</code> data frame
that contains semicolon separated positions of peptides, protein regions or amino acids in the
corresponding PDB structure or AlphaFold prediction. This information can be obtained from the
<code>find_peptide_in_structure</code> function. The corresponding column in the output is called
<code>auth_seq_id</code>. In case of AlphaFold predictions, UniProt positions should be used. If
signal positions and not stretches of amino acids are provided, the column can be numeric and
does not need to contain the semicolon separator.</p></dd>


<dt>map_value</dt>
<dd><p>a numeric column in the <code>peptide_data</code> data frame that contains a value
associated with each peptide, protein region or amino acid. If one start to end position pair
has multiple different map values, the maximum will be used. This value will be displayed as a
colour gradient when mapped onto the structure. The value can for example be the fold change,
p-value or score associated with each peptide, protein region or amino acid (selection). If
the selections should be displayed with just one colour, the value in this column should be
the same for every selection. For the mapping, values are scaled between 50 and 100. Regions
in the structure that do not map any selection receive a value of 0. If an amino acid position
is associated with multiple mapped values, e.g. from different peptides, the maximum mapped
value will be displayed.</p></dd>


<dt>file_format</dt>
<dd><p>a character vector containing the file format of the structure that will be
fetched from the database for the PDB identifiers provided in the <code>pdb_id</code> column. This
can be either ".cif" or ".pdb". The default is <code>".cif"</code>. We recommend using ".cif" files
since every structure contains a ".cif" file but not every structure contains a ".pdb" file.
Fetching and mapping onto ".cif" files takes longer than for ".pdb" files. If a structure file
is provided in the <code>structure_file</code> argument, the file format is detected automatically
and does not need to be provided.</p></dd>


<dt>scale_per_structure</dt>
<dd><p>a logical value that specifies if scaling should be performed for
each structure independently (TRUE) or over the whole data set (FALSE). The default is TRUE,
which scales the scores of each structure independently so that each structure has a score
range from 50 to 100.</p></dd>


<dt>export_location</dt>
<dd><p>optional, a character argument specifying the path to the location in
which the fetched and altered structure files should be saved. If left empty, they will be
saved in the current working directory. The location should be provided in the following
format "folderA/folderB".</p></dd>


<dt>structure_file</dt>
<dd><p>optional, a character argument specifying the path to the location and
name of a structure file in ".cif" or ".pdb" format. If a structure is provided the <code>peptide_data</code>
data frame should only contain mapping information for this structure.</p></dd>


<dt>show_progress</dt>
<dd><p>a logical, if <code>show_progress = TRUE</code>, a progress bar will be shown
(default is TRUE).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function exports a modified ".pdb" or ".cif" structure file. B-factors have been
replaced with scaled (50-100) values provided in the <code>map_value</code> column.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="va">.old_wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Load libraries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create example data</span></span></span>
<span class="r-in"><span><span class="va">peptide_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  uniprot_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P0A8T7"</span>, <span class="st">"P0A8T7"</span>, <span class="st">"P60906"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  peptide_sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"SGIVSFGKETKGKRRLVITPVDGSDPYEEMIPKWRQLNV"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"NVFEGERVER"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"AIGEVTDVVEKE"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1160</span>, <span class="fl">1197</span>, <span class="fl">55</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1198</span>, <span class="fl">1206</span>, <span class="fl">66</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  map_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find peptide positions in structures</span></span></span>
<span class="r-in"><span><span class="va">positions_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_peptide_in_structure.html">find_peptide_in_structure</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  peptide_data <span class="op">=</span> <span class="va">peptide_data</span>,</span></span>
<span class="r-in"><span>  peptide <span class="op">=</span> <span class="va">peptide_sequence</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="va">start</span>,</span></span>
<span class="r-in"><span>  end <span class="op">=</span> <span class="va">end</span>,</span></span>
<span class="r-in"><span>  uniprot_id <span class="op">=</span> <span class="va">uniprot_id</span>,</span></span>
<span class="r-in"><span>  retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">map_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pdb_ids</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"6UU2"</span>, <span class="st">"2EL9"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please note that some column names have changed due to UniProt updating its API! This might cause errors in your code. You can fix it by replacing the old column names with new ones.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2/6] Extract experimental conditions ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.07s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [3/6] Extracting polymer information: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 1/6 UniProt IDs ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.22s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 2/6 UniProt alignment ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.25s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 3/6 Ligand binding sites ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (1.78s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 4/6 Modified monomers ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.15s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 5/6 Secondary structure ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.89s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -&gt; 6/6 Unmodeled residues ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.26s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [4/6] Correct author sequence positions for some PDB IDs ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> None to correct(0.59s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [5/6] Extract non-polymer information ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.03s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [6/6] Combine information ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE (0.77s)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map peptides on structures</span></span></span>
<span class="r-in"><span><span class="co"># You can determine the preferred output location</span></span></span>
<span class="r-in"><span><span class="co"># with the export_location argument. Currently it</span></span></span>
<span class="r-in"><span><span class="co"># is saved in the working directory.</span></span></span>
<span class="r-in"><span><span class="fu">map_peptides_on_structure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  peptide_data <span class="op">=</span> <span class="va">positions_structure</span>,</span></span>
<span class="r-in"><span>  uniprot_id <span class="op">=</span> <span class="va">uniprot_id</span>,</span></span>
<span class="r-in"><span>  pdb_id <span class="op">=</span> <span class="va">pdb_ids</span>,</span></span>
<span class="r-in"><span>  chain <span class="op">=</span> <span class="va">auth_asym_id</span>,</span></span>
<span class="r-in"><span>  auth_seq_id <span class="op">=</span> <span class="va">auth_seq_id</span>,</span></span>
<span class="r-in"><span>  map_value <span class="op">=</span> <span class="va">map_value</span>,</span></span>
<span class="r-in"><span>  file_format <span class="op">=</span> <span class="st">".pdb"</span>,</span></span>
<span class="r-in"><span>  export_location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following structures were not fetched, likely because no ".pdb"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> file is available. Try using the ".cif" format for these.6UU2_P0A8T7</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">.old_wd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

