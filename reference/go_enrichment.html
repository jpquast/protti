<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform gene ontology enrichment analysis — go_enrichment • protti</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform gene ontology enrichment analysis — go_enrichment" />
<meta property="og:description" content="Analyses enrichment of gene ontology terms associated with proteins in the fraction of significant proteins compared to all detected proteins. 
A two-sided Fisher's exact test is performed to test significance of enrichment or depletion. GO annotations can be provided to this 
function either through UniProt go_annotations_uniprot, through a table obtained with fetch_go in the go_data argument
or GO annotations are fetched automatically by the function by providing ontology_type and organism_id." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jpquast/protti/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform gene ontology enrichment analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/jpquast/protti/blob/master/R/go_enrichment.R'><code>R/go_enrichment.R</code></a></small>
    <div class="hidden name"><code>go_enrichment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Analyses enrichment of gene ontology terms associated with proteins in the fraction of significant proteins compared to all detected proteins. 
A two-sided Fisher's exact test is performed to test significance of enrichment or depletion. GO annotations can be provided to this 
function either through UniProt <code>go_annotations_uniprot</code>, through a table obtained with <code>fetch_go</code> in the <code>go_data</code> argument
or GO annotations are fetched automatically by the function by providing <code>ontology_type</code> and <code>organism_id</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>go_enrichment</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>protein_id</span>,
  <span class='va'>is_significant</span>,
  go_annotations_uniprot <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>ontology_type</span>,
  organism_id <span class='op'>=</span> <span class='cn'>NULL</span>,
  go_data <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot_cutoff <span class='op'>=</span> <span class='st'>"adj_pval top10"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame that contains at least the input variables.</p></td>
    </tr>
    <tr>
      <th>protein_id</th>
      <td><p>The name of the column containing the protein accession numbers.</p></td>
    </tr>
    <tr>
      <th>is_significant</th>
      <td><p>The name of the column containing a logical indicating if the corresponding protein has a significantly changing peptide. 
The input data frame may contain peptide level information with significance information. The function is able to extract protein level information from this.</p></td>
    </tr>
    <tr>
      <th>go_annotations_uniprot</th>
      <td><p>(Recommended) The name of the column containing gene ontology annotations obtained from UniProt using <code>fetch_uniprot</code>. 
These annotations are already separated into the desired ontology type so the argument <code>ontology_type</code> is not required.</p></td>
    </tr>
    <tr>
      <th>ontology_type</th>
      <td><p>Optional, A character vector specifying the type of ontology that should be used. Possible values 
are molecular function (MF), biological process (BP), cellular component (CC). This argument is not required if GO annotations
are provided from UniProt in <code>go_annotations_uniprot</code>. It is required if annotations are provided through <code>go_data</code> or
automatically fetched.</p></td>
    </tr>
    <tr>
      <th>organism_id</th>
      <td><p>Optional, An NCBI taxonomy identifier of an organism (TaxId). Possible inputs include only: "9606" (Human), "559292" (Yeast) and 
"83333" (E. coli). Is only necessary if GO data is not provided either by <code>go_annotations_uniprot</code> or in <code>go_data</code>.</p></td>
    </tr>
    <tr>
      <th>go_data</th>
      <td><p>Optional, a data frame that can be obtained with <code>fetch_go</code>. If you provide data yourself make sure column
names for protein ID (db_id) and GO ID (go_id) are the same as for data obtained with <code>fetch_go</code>.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>A logical indicating whether the result should be plotted or returned as a table.</p></td>
    </tr>
    <tr>
      <th>plot_cutoff</th>
      <td><p>A character vector indicating if the plot should contain the top 10 most significant proteins (p-value or adjusted p-value), 
or if a significance cutoff should be used to determine the number of GO terms in the plot. This information should be provided with the 
type first followed by the threshold separated by a space. Example are <code>plot_cutoff = "adj_pval top10"</code>, <code>plot_cutoff = "pval 0.05"</code> 
or <code>plot_cutoff = "adj_pval 0.01"</code>. The threshold can be chosen freely.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A bar plot displaying negative log10 adjusted p-values for the top 10 enriched or depleted gene ontology terms. Alternatively, 
plot cutoffs can be chosen individually with the <code>plot_cutoff</code> argument. 
Bars are colored according to the direction of the enrichment. If <code>plot = FALSE</code>, a data frame is returned. P-values 
are adjusted with Benjamini-Hochberg.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>go_enrichment</span><span class='op'>(</span>
<span class='va'>data</span>,
protein_id <span class='op'>=</span> <span class='va'>pg_protein_accessions</span>,
is_significant <span class='op'>=</span> <span class='va'>significant</span>,
go_annotations_uniprot <span class='op'>=</span> <span class='va'>go_molecular_function</span>
<span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jan-Philipp Quast, Dina Schuster.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


