<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Volcano plot — volcano_plot • protti</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Volcano plot — volcano_plot"><meta property="og:description" content="Plots a volcano plot for the given input."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Volcano plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/HEAD/R/volcano_plot.R" class="external-link"><code>R/volcano_plot.R</code></a></small>
    <div class="hidden name"><code>volcano_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots a volcano plot for the given input.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">volcano_plot</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">grouping</span>,
  <span class="va">log2FC</span>,
  <span class="va">significance</span>,
  <span class="va">method</span>,
  target_column <span class="op">=</span> <span class="cn">NULL</span>,
  target <span class="op">=</span> <span class="cn">NULL</span>,
  facet_by <span class="op">=</span> <span class="cn">NULL</span>,
  title <span class="op">=</span> <span class="st">"Volcano plot"</span>,
  x_axis_label <span class="op">=</span> <span class="st">"log2(fold change)"</span>,
  y_axis_label <span class="op">=</span> <span class="st">"-log10(p-value)"</span>,
  legend_label <span class="op">=</span> <span class="st">"Target"</span>,
  log2FC_cutoff <span class="op">=</span> <span class="fl">1</span>,
  significance_cutoff <span class="op">=</span> <span class="fl">0.01</span>,
  interactive <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a data frame that contains at least the input variables.</p></dd>
<dt>grouping</dt>
<dd><p>a character column in the <code>data</code> data frame that contains either precursor
or peptide identifiers.</p></dd>
<dt>log2FC</dt>
<dd><p>a character column in the <code>data</code> data frame that contains the log2
transfromed fold changes between two conditions.</p></dd>
<dt>significance</dt>
<dd><p>a character column in the <code>data</code> data frame that contains the p-value
or adjusted p-value for the corresponding fold changes. The values in this column will be
transformed using the -log10 and displayed on the y-axis of the plot.</p></dd>
<dt>method</dt>
<dd><p>a character value that specifies the method used for the plot.
<code>method = "target"</code> highlights your protein, proteins or any other entities of interest
(specified in the <code>target</code> argument) in the volcano plot. <code>method = "significant"</code>
highlights all significantly changing entities.</p></dd>
<dt>target_column</dt>
<dd><p>optional, a column required for <code>method = "target"</code>, can contain for
example protein identifiers or a logical that marks certain proteins such as proteins that are
known to interact with the treatment. Can also be provided if <code>method = "significant"</code>
to label data points in an interactive plot.</p></dd>
<dt>target</dt>
<dd><p>optional, a vector required for <code>method = "target"</code>. It
can contain one or more specific entities of the column provided in <code>target_column</code>. This
can be for example a protein ID if <code>target_column</code> contains protein IDs or TRUE or FALSE
for a logical column.</p></dd>
<dt>facet_by</dt>
<dd><p>optional, a character column that contains information by which the data should
be faceted into multiple plots.</p></dd>
<dt>title</dt>
<dd><p>optional, a character value that specifies the title of the volcano plot. Default
is "Volcano plot".</p></dd>
<dt>x_axis_label</dt>
<dd><p>optional, a character value that specifies the x-axis label. Default is
"log2(fold change)".</p></dd>
<dt>y_axis_label</dt>
<dd><p>optional, a character value that specifies the y-axis label. Default is
"-log10(q-value)".</p></dd>
<dt>legend_label</dt>
<dd><p>optional, a character value that specifies the legend label. Default is
"Target".</p></dd>
<dt>log2FC_cutoff</dt>
<dd><p>optional, a numeric value that specifies the log2 transformed fold change
cutoff used for the vertical lines, which can be used to assess the significance of changes.
Default value is 1.</p></dd>
<dt>significance_cutoff</dt>
<dd><p>optional, a character vector that specifies the p-value cutoff used
for the horizontal cutoff line, which can be used to assess the significance of changes. The
vector can consist solely of one element, which is the cutoff value. In that case the cutoff
will be applied directly to the plot. Alternatively, a second element can be provided to the
vector that specifies a column in the <code>data</code> data frame which contains e.g. adjusted
p-values. In that case the y-axis of the plot could display p-values that are provided to the
<code>significance</code> argument, while the horizontal cutoff line is on the scale of adjusted
p-values transformed to the scale of p-values. The provided vector can be e.g.
<code>c(0.05, "adj_pval")</code>. In that case the function looks for the closest adjusted p-value
above and below 0.05 and takes the mean of the corresponding p-values as the cutoff line. If
there is no adjusted p-value in the data that is below 0.05 no line is displayed. This allows
the user to display volcano plots using p-values while using adjusted p-values for the cutoff
criteria. This is often preferred because adjusted p-values are related to unadjusted p-values
often in a complex way that makes them hard to be interpret when plotted. Default is <code>c(0.01)</code>.</p></dd>
<dt>interactive</dt>
<dd><p>a logical value that specifies whether the plot should be interactive
(default is FALSE).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the method used a volcano plot with either highlighted targets
(<code>method = "target"</code>) or highlighted significant proteins (<code>method = "significant"</code>)
is returned.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># Makes example reproducible</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create synthetic data</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_synthetic_data.html">create_synthetic_data</a></span><span class="op">(</span></span>
<span class="r-in">  n_proteins <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  frac_change <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span class="r-in">  n_replicates <span class="op">=</span> <span class="fl">4</span>,</span>
<span class="r-in">  n_conditions <span class="op">=</span> <span class="fl">3</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="st">"effect_random"</span>,</span>
<span class="r-in">  additional_metadata <span class="op">=</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Assign missingness information</span></span>
<span class="r-in"><span class="va">data_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="assign_missingness.html">assign_missingness</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="va">data</span>,</span>
<span class="r-in">  sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span class="r-in">  condition <span class="op">=</span> <span class="va">condition</span>,</span>
<span class="r-in">  grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span class="r-in">  intensity <span class="op">=</span> <span class="va">peptide_intensity_missing</span>,</span>
<span class="r-in">  ref_condition <span class="op">=</span> <span class="st">"all"</span>,</span>
<span class="r-in">  retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">protein</span>, <span class="va">change_peptide</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> "all" was provided as reference condition. All pairwise comparisons are</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> created from the conditions and assigned their missingness. The</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> created comparisons are:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> condition_1_vs_condition_2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> condition_1_vs_condition_3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> condition_2_vs_condition_3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Calculate differential abundances</span></span>
<span class="r-in"><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_diff_abundance.html">calculate_diff_abundance</a></span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">data_missing</span>,</span>
<span class="r-in">  sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span class="r-in">  condition <span class="op">=</span> <span class="va">condition</span>,</span>
<span class="r-in">  grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span class="r-in">  intensity_log2 <span class="op">=</span> <span class="va">peptide_intensity_missing</span>,</span>
<span class="r-in">  missingness <span class="op">=</span> <span class="va">missingness</span>,</span>
<span class="r-in">  comparison <span class="op">=</span> <span class="va">comparison</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="st">"moderated_t-test"</span>,</span>
<span class="r-in">  retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">protein</span>, <span class="va">change_peptide</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [1/7] Creating moderated t-test input data ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2/7] Defining moderated t-test design ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [3/7] Fitting lmFit model ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [4/7] Construct matrix of custom contrasts ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [5/7] Compute contrasts from linear model fit ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [6/7] Compute empirical Bayes statistics ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [7/7] Create result table ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> DONE</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">volcano_plot</span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">diff</span>,</span>
<span class="r-in">  grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span class="r-in">  log2FC <span class="op">=</span> <span class="va">diff</span>,</span>
<span class="r-in">  significance <span class="op">=</span> <span class="va">pval</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="st">"target"</span>,</span>
<span class="r-in">  target_column <span class="op">=</span> <span class="va">change_peptide</span>,</span>
<span class="r-in">  target <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  facet_by <span class="op">=</span> <span class="va">comparison</span>,</span>
<span class="r-in">  significance_cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="st">"adj_pval"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="volcano_plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

