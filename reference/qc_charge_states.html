<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Check charge state distribution — qc_charge_states • protti</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Check charge state distribution — qc_charge_states" />
<meta property="og:description" content="Calculates the charge state distribution for each sample (by count or intensity)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jpquast/protti/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Check charge state distribution</h1>
    <small class="dont-index">Source: <a href='https://github.com/jpquast/protti/blob/master/R/qc_charge_states.R'><code>R/qc_charge_states.R</code></a></small>
    <div class="hidden name"><code>qc_charge_states.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the charge state distribution for each sample (by count or intensity).</p>
    </div>

    <pre class="usage"><span class='fu'>qc_charge_states</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>sample</span>,
  <span class='va'>grouping</span>,
  <span class='va'>charge_states</span>,
  intensity <span class='op'>=</span> <span class='cn'>NULL</span>,
  remove_na_intensities <span class='op'>=</span> <span class='cn'>TRUE</span>,
  method <span class='op'>=</span> <span class='st'>"count"</span>,
  plot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  interactive <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame that contains at least sample names, peptide or precursor identifiers
and missed cleavage counts for each peptide or precursor.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>a character column in the <code>data</code> data frame that contains the sample name.</p></td>
    </tr>
    <tr>
      <th>grouping</th>
      <td><p>a character column in the <code>data</code> data frame that contains either precursor or
peptide identifiers.</p></td>
    </tr>
    <tr>
      <th>charge_states</th>
      <td><p>a character or numeric column in the <code>data</code> data frame that contains
the different charge states assigned to the precursor or peptide.</p></td>
    </tr>
    <tr>
      <th>intensity</th>
      <td><p>a numeric column in the <code>data</code> data frame that contains the corresponding
raw or normalised intensity values (not log2) for each peptide or precursor. Required when
"intensity" is chosen as the method.</p></td>
    </tr>
    <tr>
      <th>remove_na_intensities</th>
      <td><p>a logical value that specifies if sample/grouping combinations with
intensities that are NA (not quantified IDs) should be dropped from the data frame for analysis
of missed cleavages. Default is TRUE since we are usually interested in quantifiable peptides.
This is only relevant for method = "count".</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a character value that indicates the method used for evaluation. "count"
calculates the charge state distribution based on counts of the corresponding peptides or
precursors in the charge state group, "intensity" calculates the percentage of precursors or
peptides in each charge state group based on the corresponding intensity values.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>a logical value that indicates whether the result should be plotted.</p></td>
    </tr>
    <tr>
      <th>interactive</th>
      <td><p>a logical value that specifies whether the plot should be interactive
(default is FALSE).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame that contains the calculated percentage made up by the sum of either
all counts or intensities of peptides or precursors of the corresponding charge state
(depending on which method is chosen).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load libraries</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span> <span class='co'># Makes example reproducible</span>

<span class='co'># Create example data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='create_synthetic_data.html'>create_synthetic_data</a></span><span class='op'>(</span>
  n_proteins <span class='op'>=</span> <span class='fl'>100</span>,
  frac_change <span class='op'>=</span> <span class='fl'>0.05</span>,
  n_replicates <span class='op'>=</span> <span class='fl'>3</span>,
  n_conditions <span class='op'>=</span> <span class='fl'>2</span>,
  method <span class='op'>=</span> <span class='st'>"effect_random"</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>intensity_non_log2 <span class='op'>=</span> <span class='fl'>2</span><span class='op'>^</span><span class='va'>peptide_intensity_missing</span><span class='op'>)</span>

<span class='co'># Calculate charge percentages</span>
<span class='fu'>qc_charge_states</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>data</span>,
  sample <span class='op'>=</span> <span class='va'>sample</span>,
  grouping <span class='op'>=</span> <span class='va'>peptide</span>,
  charge_states <span class='op'>=</span> <span class='va'>charge</span>,
  intensity <span class='op'>=</span> <span class='va'>intensity_non_log2</span>,
  method <span class='op'>=</span> <span class='st'>"intensity"</span>,
  plot <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 30 × 3</span>
#&gt;    sample   charge charge_per
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> sample_1 1          7.01  
#&gt; <span style='color: #BCBCBC;'> 2</span> sample_1 2         47.2   
#&gt; <span style='color: #BCBCBC;'> 3</span> sample_1 3         42.6   
#&gt; <span style='color: #BCBCBC;'> 4</span> sample_1 4          3.19  
#&gt; <span style='color: #BCBCBC;'> 5</span> sample_1 5          0.035<span style='text-decoration: underline;'>8</span>
#&gt; <span style='color: #BCBCBC;'> 6</span> sample_2 1          8.64  
#&gt; <span style='color: #BCBCBC;'> 7</span> sample_2 2         48.1   
#&gt; <span style='color: #BCBCBC;'> 8</span> sample_2 3         39.9   
#&gt; <span style='color: #BCBCBC;'> 9</span> sample_2 4          3.33  
#&gt; <span style='color: #BCBCBC;'>10</span> sample_2 5          0.058<span style='text-decoration: underline;'>1</span>
#&gt; <span style='color: #949494;'># … with 20 more rows</span></div><div class='input'>
<span class='co'># Plot charge states</span>
<span class='fu'>qc_charge_states</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>data</span>,
  sample <span class='op'>=</span> <span class='va'>sample</span>,
  grouping <span class='op'>=</span> <span class='va'>peptide</span>,
  charge_states <span class='op'>=</span> <span class='va'>charge</span>,
  intensity <span class='op'>=</span> <span class='va'>intensity_non_log2</span>,
  method <span class='op'>=</span> <span class='st'>"intensity"</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
</div><div class='img'><img src='qc_charge_states-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


