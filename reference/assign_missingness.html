<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Assignment of missingness types — assign_missingness • protti</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Assignment of missingness types — assign_missingness"><meta property="og:description" content="The type of missingness (missing at random, missing not at random) is assigned based on the
comparison of a reference condition and every other condition."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="../articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assignment of missingness types</h1>
    <small class="dont-index">Source: <a href="https://github.com/jpquast/protti/blob/HEAD/R/assign_missingness.R" class="external-link"><code>R/assign_missingness.R</code></a></small>
    <div class="hidden name"><code>assign_missingness.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The type of missingness (missing at random, missing not at random) is assigned based on the
comparison of a reference condition and every other condition.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">assign_missingness</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">sample</span>,
  <span class="va">condition</span>,
  <span class="va">grouping</span>,
  <span class="va">intensity</span>,
  ref_condition <span class="op">=</span> <span class="st">"all"</span>,
  completeness_MAR <span class="op">=</span> <span class="fl">0.7</span>,
  completeness_MNAR <span class="op">=</span> <span class="fl">0.2</span>,
  retain_columns <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a data frame containing at least the input variables.</p></dd>
<dt>sample</dt>
<dd><p>a character column in the <code>data</code> data frame that contains the sample name.</p></dd>
<dt>condition</dt>
<dd><p>a character or numeric column in the <code>data</code> data frame that contains the
conditions.</p></dd>
<dt>grouping</dt>
<dd><p>a character column in the <code>data</code> data frame that contains precursor or
peptide identifiers.</p></dd>
<dt>intensity</dt>
<dd><p>a numeric column in the <code>data</code> data frame that contains intensity values.</p></dd>
<dt>ref_condition</dt>
<dd><p>a character vector providing the condition that is used as a reference for
missingness determination. Instead of providing one reference condition, "all" can be supplied,
which will create all pairwise condition pairs. By default <code>ref_condition = "all"</code>.</p></dd>
<dt>completeness_MAR</dt>
<dd><p>a numeric value that specifies the minimal degree of data completeness to
be considered as MAR. Value has to be between 0 and 1, default is 0.7. It is multiplied with
the number of replicates and then adjusted downward. The resulting number is the minimal number
of observations for each condition to be considered as MAR. This number is always at least 1.</p></dd>
<dt>completeness_MNAR</dt>
<dd><p>a numeric value that specifies the maximal degree of data completeness to
be considered as MNAR. Value has to be between 0 and 1, default is 0.20. It is multiplied with
the number of replicates and then adjusted downward. The resulting number is the maximal number
of observations for one condition to be considered as MNAR when the other condition is complete.</p></dd>
<dt>retain_columns</dt>
<dd><p>a vector that indicates columns that should be retained from the input
data frame. Default is not retaining additional columns <code>retain_columns = NULL</code>. Specific
columns can be retained by providing their names (not in quotations marks, just like other
column names, but in a vector).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame that contains the reference condition paired with each treatment condition.
The <code>comparison</code> column contains the comparison name for the specific treatment/reference
pair. The <code>missingness</code> column reports the type of missingness.</p><ul><li><p>"complete": No missing values for every replicate of this reference/treatment pair for
the specific grouping variable.</p></li>
<li><p>"MNAR": Missing not at random. All replicates of either the reference or treatment
condition have missing values for the specific grouping variable.</p></li>
<li><p>"MAR": Missing at random. At least n-1 replicates have missing values for the
reference/treatment pair for the specific grouping varible.</p></li>
<li><p>NA: The comparison is not complete enough to fall into any other category. It will not
be imputed if imputation is performed. For statistical significance testing these comparisons
are filtered out after the test and prior to p-value adjustment. This can be prevented by setting
<code>filter_NA_missingness = FALSE</code> in the <code><a href="calculate_diff_abundance.html">calculate_diff_abundance()</a></code> function.</p></li>
</ul><p>The type of missingness has an influence on the way values are imputeted if imputation is
performed subsequently using the <code><a href="impute.html">impute()</a></code> function. How each type of missingness is
specifically imputed can be found in the function description. The type of missingness
assigned to a comparison does not have any influence on the statistical test in the
<code><a href="calculate_diff_abundance.html">calculate_diff_abundance()</a></code> function.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># Makes example reproducible</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create example data</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_synthetic_data.html">create_synthetic_data</a></span><span class="op">(</span></span>
<span class="r-in">  n_proteins <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  frac_change <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span class="r-in">  n_replicates <span class="op">=</span> <span class="fl">4</span>,</span>
<span class="r-in">  n_conditions <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="st">"effect_random"</span>,</span>
<span class="r-in">  additional_metadata <span class="op">=</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    protein   peptide     condition sample peptide_intensi… change change_peptide</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> protein_1 peptide_1_1 conditio… sampl…             16.8 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> protein_1 peptide_1_1 conditio… sampl…             17.0 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> protein_1 peptide_1_1 conditio… sampl…             17.0 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> protein_1 peptide_1_1 conditio… sampl…             17.0 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> protein_1 peptide_1_1 conditio… sampl…             15.8 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> protein_1 peptide_1_1 conditio… sampl…             15.9 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> protein_1 peptide_1_1 conditio… sampl…             16.1 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> protein_1 peptide_1_1 conditio… sampl…             15.9 TRUE   TRUE          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> protein_1 peptide_1_2 conditio… sampl…             12.6 TRUE   FALSE         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> protein_1 peptide_1_2 conditio… sampl…             12.7 TRUE   FALSE         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 14 more rows, and 1 more variable: peptide_intensity_missing &lt;dbl&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Assign missingness information</span></span>
<span class="r-in"><span class="va">data_missing</span> <span class="op">&lt;-</span> <span class="fu">assign_missingness</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">data</span>,</span>
<span class="r-in">  sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span class="r-in">  condition <span class="op">=</span> <span class="va">condition</span>,</span>
<span class="r-in">  grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span class="r-in">  intensity <span class="op">=</span> <span class="va">peptide_intensity_missing</span>,</span>
<span class="r-in">  ref_condition <span class="op">=</span> <span class="st">"all"</span>,</span>
<span class="r-in">  retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> "all" was provided as reference condition. All pairwise comparisons are</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> created from the conditions and assigned their missingness. The</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> created comparisons are:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> condition_1_vs_condition_2</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_missing</span>, n <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    protein   sample   condition  peptide peptide_intensi… comparison missingness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> protein_1 sample_1 condition… peptid…             16.8 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> protein_1 sample_2 condition… peptid…             17.0 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> protein_1 sample_3 condition… peptid…             17.0 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> protein_1 sample_4 condition… peptid…             17.0 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> protein_1 sample_5 condition… peptid…             15.8 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> protein_1 sample_6 condition… peptid…             15.9 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> protein_1 sample_7 condition… peptid…             16.1 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> protein_1 sample_8 condition… peptid…             15.9 condition… complete   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> protein_1 sample_1 condition… peptid…             <span style="color: #BB0000;">NA</span>   condition… <span style="color: #BB0000;">NA</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> protein_1 sample_2 condition… peptid…             <span style="color: #BB0000;">NA</span>   condition… <span style="color: #BB0000;">NA</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 14 more rows</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

