<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bottom-Up Proteomics and LiP-MS Quality Control and Data Analysis Tools • protti</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bottom-Up Proteomics and LiP-MS Quality Control and Data Analysis Tools">
<meta property="og:description" content="Useful functions and workflows for proteomics quality control and data analysis of both limited proteolysis-coupled mass spectrometry (LiP-MS) (Feng et. al. (2014) &lt;doi:10.1038/nbt.2999&gt;) and regular bottom-up proteomics experiments. Data generated with search tools such as Spectronaut, MaxQuant and Proteome Discover can be easily used due to flexibility of functions.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">protti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/data_analysis_dose_response_workflow.html">Dose-Response Data Analysis Workflow</a>
    </li>
    <li>
      <a href="articles/data_analysis_single_dose_treatment_workflow.html">Single Dose Treatment Data Analysis Workflow</a>
    </li>
    <li>
      <a href="articles/input_preparation_workflow.html">Input Preparation Workflow</a>
    </li>
    <li>
      <a href="articles/protein_structure_workflow.html">Protein Structure Analysis Workflow</a>
    </li>
    <li>
      <a href="articles/quality_control_workflow.html">Qualtiy Control (QC) Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jpquast/protti/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="protti-">protti <img src="reference/figures/logo.png" align="right" width="12.5%"><a class="anchor" aria-label="anchor" href="#protti-"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of <strong>protti</strong> is to provide flexible functions and workflows for proteomics quality control and data analysis, within a single, user-friendly package. It can be used for label-free DDA, DIA and SRM data generated with search tools and software such as Spectronaut, MaxQuant, Proteome Discoverer and Skyline. Both limited proteolysis mass spectrometry (LiP-MS) and regular bottom-up proteomics experiments can be analysed.</p>
<p><strong>protti</strong> is developed and maintained by members of the lab of Paola Picotti at ETH Zurich. Our lab is focused on protein structural changes that occur in response to perturbations such as metabolite, drug and protein binding-events, as well as protein aggregation and enzyme activation (<a href="https://www.sciencedirect.com/science/article/pii/S0092867417314484" class="external-link">Piazza 2018</a>, <a href="https://www.nature.com/articles/s41467-020-18071-x#additional-information" class="external-link">Piazza 2020</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0092867420316913" class="external-link">Cappelletti, Hauser &amp; Piazza 2021</a>). We have devoloped mass spectrometry-based structural and chemical proteomic methods aimed at monitoring protein conformational changes in the complex cellular milieu (<a href="https://www.nature.com/articles/nbt.2999" class="external-link">Feng 2014</a>).</p>
<p>There is a wide range of functions <strong>protti</strong> provides to the user. The main areas of application are:</p>
<ul>
<li>
<strong>Quality control</strong>: Check a multitude of quality control parameters in your data.</li>
<li>
<strong>Filter for quality</strong>: Prior to data analysis you can filter your data to exclude any observations that are of low quality and potentially not trustworthy.</li>
<li>
<strong>Imputation</strong>: You can choose to impute your data using several different methods.</li>
<li>
<strong>Data analysis</strong>: Analyse your data for differential abundance of proteins, peptides or precursors.
<ul>
<li>
<strong>Binary treatment</strong>: Experiments with one control condition and at least one treatment condition in which the control is compared to each of the treatment conditions.</li>
<li>
<strong>Dose-response treatment</strong>: Experiments that contain increasing concentrations of the treatment in which a log-logistic dose-response curve is fitted to each protein, peptide or precursor in your data.</li>
</ul>
</li>
<li>
<strong>Enrichment and interaction analysis</strong>: Check the list of your significantly changing proteins for e.g. gene ontology enrichments or perform a network analysis using the STRING database directly in R.</li>
<li>
<strong>Databases</strong>: You can easily access several databases relevant for proteomics (e.g. UniProt) and load any data that interests you directly into R.</li>
</ul>
<div class="section level3">
<h3 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h3>
<p>The protti package has been peer-reviewed and was published in <em>Bioinformatics Advances</em>:</p>
<p>Jan-Philipp Quast, Dina Schuster, Paola Picotti. protti: an R package for comprehensive data analysis of peptide- and protein-centric bottom-up proteomics data. <em>Bioinformatics Advances</em>, Volume 2, Issue 1, 2022, vbab041, <a href="https://doi.org/10.1093/bioadv/vbab041" class="external-link uri">https://doi.org/10.1093/bioadv/vbab041</a></p>
<p>Please make sure to cite this publication if you used protti for your data analysis.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>protti</strong> is implemented as an R package.</p>
<p>You can install the release version from <a href="https://CRAN.R-project.org/package=protti" class="external-link">CRAN</a> using the <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"protti"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version from <a href="https://github.com/jpquast/protti" class="external-link">GitHub</a> using the <a href="https://github.com/r-lib/devtools" class="external-link"><code>devtools</code></a> package by copying the following commands into R:</p>
<p>Note: If you do not have <code>devtools</code> installed make sure to do so by removing the comment sign (#).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jpquast/protti"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>dependencies = TRUE</code> argument in both <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> and <code>devtools::install_github()</code> also installs suggested packages that are required for some functions to work. If this argument is not included functions that use a package that is not installed by default will throw an error and prompt the user to install the missing package. If you happen to run into problems during the installation of <strong>protti</strong> we recommend removing this argument and installing packages manually if they are needed for a certain function.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Since <strong>protti</strong> is designed to be a flexible tool for the analysis of your data, there are many ways in which it can be used. In this section we will give a general overview for a very simple pipeline that takes a result from the search tool of your choice and in a few steps returns a list of significantly changing proteins or peptides. To ensure that you have your data in the right format please check out the <a href="https://jpquast.github.io/protti/articles/input_preparation_workflow.html" class="external-link">input preparation vignette</a>.</p>
<p>A complete list of functions and their documentation is available <a href="https://jpquast.github.io/protti/reference/" class="external-link">here</a>. Within R you can access the same documentation by calling <code>?</code> followed by the function name without parenthesis.</p>
<p>In general functions with the prefix <code>qc_*</code> are used for quality control of your data. Functions starting with <code>fetch_*</code> allow you to retrieve data from a database directly into your R session. When a function starts with <code>filter_*</code> it is meant to be used to filter your data prior to analysis.</p>
<p>For more in detail workflow suggestions and demonstrations of various functions, you can have a look at the package vignettes. These include:</p>
<ul>
<li><a href="https://jpquast.github.io/protti/articles/input_preparation_workflow.html" class="external-link">Input Preparation Workflow</a></li>
<li><a href="https://jpquast.github.io/protti/articles/quality_control_workflow.html" class="external-link">Quality Control Workflow</a></li>
<li><a href="https://jpquast.github.io/protti/articles/data_analysis_single_dose_treatment_workflow.html" class="external-link">Single Dose Treatment Data Analysis Workflow</a></li>
<li><a href="https://jpquast.github.io/protti/articles/data_analysis_dose_response_workflow.html" class="external-link">Dose-Response Data Analysis Workflow</a></li>
<li><a href="https://jpquast.github.io/protti/articles/protein_structure_workflow.html" class="external-link">Protein Structure Analysis Workflow</a></li>
</ul>
<div class="section level3">
<h3 id="data-analysis">Data analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h3>
<p>In this example we are going to analyse synthetic data of which we know the ground truth. The same principles would apply to any real data. Before you start analysing your data you should load all required packages. <strong>protti</strong> is designed to work well with the <a href="https://www.tidyverse.org" class="external-link"><code>tidyverse</code></a> package family and we will use them for this example. Therefore, you should also load them before you get started. Note: If you do not have the <code>tidyverse</code> installed you can do so by removing the comment sign (#) in front of the <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> function. This will install them directly from CRAN.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load protti</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jpquast/protti" class="external-link">protti</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install the tidyverse if necessary</span></span>
<span><span class="co"># install.packages("tidyverse")</span></span>
<span></span>
<span><span class="co"># Load tidyverse packages. Can also be done by calling library(tidyverse)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="load-data">Load Data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h4>
<p>Usually the search tool of your choice generates a report for you that has either a <code>.txt</code> or <code>.csv</code> format. You can easily load reports into R by using the <code><a href="reference/read_protti.html">read_protti()</a></code> function. This function is a wrapper around the fast <code>fread()</code> function from the <code>data.table</code> package and the <code>clean_names()</code> function from the <code>janitor</code> package. This will allow you to not only load your data into R very fast, but also to clean up the column names into lower snake case. This will make it easier to remember them and to use them in your data analysis.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_protti.html">read_protti</a></span><span class="op">(</span><span class="st">"filename.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Since we will use synthetic data for this example we are going to call the <code><a href="reference/create_synthetic_data.html">create_synthetic_data()</a></code> function from <strong>protti</strong>. Of course you do not need to do this step in your analysis pipeline.</p>
<p>The data this function creates is similar to data obtained from a LiP-MS experiment. Please note that any of the steps in this workflow can also be applied to protein abundance data that contains protein IDs and protein intensities.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span> <span class="co"># Makes example reproducible</span></span>
<span></span>
<span><span class="co"># Create synthetic data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_synthetic_data.html">create_synthetic_data</a></span><span class="op">(</span>n_proteins <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                              frac_change <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                              n_replicates <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                              n_conditions <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"effect_random"</span>,</span>
<span>                              additional_metadata <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The method "effect_random" as opposed to "dose-response" just randomly samples </span></span>
<span><span class="co"># the extend of the change of significantly changing peptides for each condition. </span></span>
<span><span class="co"># They do not follow any trend and can go in any direction.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clean-and-normalise-data">Clean and Normalise Data<a class="anchor" aria-label="anchor" href="#clean-and-normalise-data"></a>
</h4>
<p>Before you start analysing your data it is recommended that you filter out any observations not necessary for your analysis. These include for example:</p>
<ul>
<li>
<strong>Decoys</strong>: Sometimes decoys are included in reports and it is advised to filter them out before data analysis.</li>
<li>
<strong>Contaminants</strong>: MaxQuant includes contaminant information in their reports. Contaminants are useful for quality control purposes but should be filtered out for analysis.</li>
<li>
<strong>Non-Proteotypic Peptides</strong>: For the analysis of LiP-MS data you should not include non-proteotypic peptides in your analysis since it is not possible to make sense of them in case they change significantly.</li>
</ul>
<p>On your own data you can easily achieve this with <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> function. Our synthetic data does not require any filtering at this step.</p>
<p>Due to the fact that variances increase with increasing raw intensities, statistical tests would have a bias towards lower-intensity peptides or proteins. Therefore you should log2 transform your data to correct for this mean-variance relationship. We do not need to do this for the synthetic data as it is already log2 transformed. For your own data just use <code>dplyr</code>’s <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> together with <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2()</a></code>.</p>
<p>In addition to filtering and log2 transformation it is also advised to normalise your data to equal out small differences in overall sample intensities that result from unequal sample concentrations. <strong>protti</strong> provides the <code><a href="reference/normalise.html">normalise()</a></code> function for this purpose. For this example we will use median normalisation (<code>method = "median"</code>). This function generates an additional column called <code>normalised_intensity_log2</code> that contains the normalised intensities.</p>
<p><em>Note: If your search tool already normalised your data you should not normalise it another time.</em></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalised_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="reference/normalise.html">normalise</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>            intensity_log2 <span class="op">=</span> <span class="va">peptide_intensity_missing</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="assign-missingness">Assign Missingness<a class="anchor" aria-label="anchor" href="#assign-missingness"></a>
</h4>
<p>The next step is to deal with missing data points. You could choose to impute missing data in a later step, but this is only recommended if only a small proportion of your data is missing. In order to calculate statistical significance of differentially abundant peptides or proteins we would like to have at least a minimum number of observations per condition. The <strong>protti</strong> function <code><a href="reference/assign_missingness.html">assign_missingness()</a></code> checks for each treatment-to-reference condition if the defined minimum number of observations is satisfied and assigns a missingness type to each comparison as follows.</p>
<p>If a certain condition has all replicates while the other one has less than 20% (adjusted downward) of total possible replicates, the case is considered to be “missing not at random” (<code>MNAR</code>). In order to be labeled “missing at random” (<code>MAR</code>) 70% (adjusted downward) of total replicates need to be present in both conditions. If you performed an experiment with 4 replicates that means that both conditions need to contain at least 2 observations. Comparisons that have too few observations are labeled <code>NA</code>. These will not be imputed if imputation is performed later on using the <code><a href="reference/impute.html">impute()</a></code> function. You can read the exact details in the documentation of this function and also adjust the thresholds if you want to be more or less conservative with how many data points to retain.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_missing</span> <span class="op">&lt;-</span> <span class="va">normalised_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="reference/assign_missingness.html">assign_missingness</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                     condition <span class="op">=</span> <span class="va">condition</span>,</span>
<span>                     grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span>                     intensity <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>                     ref_condition <span class="op">=</span> <span class="st">"condition_1"</span>,</span>
<span>                     retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">protein</span>, <span class="va">change_peptide</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Next to the columns it generates, assign_missingness only contains the columns </span></span>
<span><span class="co"># you provide as input in its output. If you want to retain additional columns you </span></span>
<span><span class="co"># can provide them in the retain_columns argument.</span></span></code></pre></div>
<p><em>Note: Instead of “peptide” in the <code>grouping</code> argument you can provide protein IDs in case you are working with protein abundance data. However, then intensities should be protein intensities and not peptide intensities.</em></p>
</div>
<div class="section level4">
<h4 id="calculate-differential-abundance-and-significance">Calculate Differential Abundance and Significance<a class="anchor" aria-label="anchor" href="#calculate-differential-abundance-and-significance"></a>
</h4>
<p>For the calculation of abundance changes and the associated significances <strong>protti</strong> provides the function <code><a href="reference/calculate_diff_abundance.html">calculate_diff_abundance()</a></code>. You can choose between different statistical methods. For this example we will chose a moderated t-test.</p>
<p>The type of missingness assigned to a comparison does not have any influence on the statistical test. However, by default (can be changed) comparisons with missingness <code>NA</code> are filtered out prior to p-value adjustment. This means that in addition to imputation, the user can use missingness cutoffs also in order to define which comparisons are too incomplete to be trustworthy even if significant.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">data_missing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="reference/calculate_diff_abundance.html">calculate_diff_abundance</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           condition <span class="op">=</span> <span class="va">condition</span>,</span>
<span>                           grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span>                           intensity_log2 <span class="op">=</span> <span class="va">normalised_intensity_log2</span>,</span>
<span>                           missingness <span class="op">=</span> <span class="va">missingness</span>,</span>
<span>                           comparison <span class="op">=</span> <span class="va">comparison</span>,</span>
<span>                           filter_NA_missingness <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"moderated_t-test"</span>,</span>
<span>                           retain_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">protein</span>, <span class="va">change_peptide</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we can use a Volcano plot to visualize significantly changing peptides with the function <code><a href="reference/volcano_plot.html">volcano_plot()</a></code>. You can choose to create an interactive plot with the <code>interactive</code> argument. Please note that this is not recommended for large datasets.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="reference/volcano_plot.html">volcano_plot</a></span><span class="op">(</span>grouping <span class="op">=</span> <span class="va">peptide</span>,</span>
<span>                 log2FC <span class="op">=</span> <span class="va">diff</span>,</span>
<span>                 significance <span class="op">=</span> <span class="va">pval</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"target"</span>,</span>
<span>                 target_column <span class="op">=</span> <span class="va">change_peptide</span>,</span>
<span>                 target <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 legend_label <span class="op">=</span> <span class="st">"Ground Truth"</span>,</span>
<span>                 significance_cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="st">"adj_pval"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-volcano-1.png" width="100%"></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=protti" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/jpquast/protti/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jpquast/protti/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing protti</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jan-Philipp Quast <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2713-778X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Dina Schuster <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-6611-8237" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>ETH Zurich <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jpquast/protti/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/jpquast/protti/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/jpquast/protti?branch=master" class="external-link"><img src="https://codecov.io/gh/jpquast/protti/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://CRAN.R-project.org/package=protti" class="external-link"><img src="https://www.r-pkg.org/badges/version/protti" alt="CRAN status"></a></li>
<li><a href="https://doi.org/10.1093/bioadv/vbab041" class="external-link"><img src="http://img.shields.io/badge/DOI-10.1093/bioadv/vbab041-5680C1.svg" alt="DOI:10.1093/bioadv/vbab041"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan-Philipp Quast, Dina Schuster, ETH Zurich.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
